\begin{titlepage}
\flushright
\vspace*{7cm}

{\garet\fontsize{48}{54}\bfseries
\text{Analysis (I)} %main title
}

\vspace{0.2cm}
% \Large{\cjkserif{}} %subtitle
   
\vspace{2 cm}
\Large{by Poshen Chang}%your name

\large{v.1}%YOUR NUMBER

\vspace{3.5 cm}
\Large{\today}%date

% \vspace{0.25 cm}
% \Large{\myfont }%place

\vfill
\end{titlepage}

\tableofcontents

\resetcounters
\justifying
% \thispagestyle{fancy}
\setlength{\parindent}{2em}

% \newtcolorbox{mybox}[2][]{}

% \tcbset{after title={\hfill\colorbox{black}{\mdseries\color{white} solved}}}

% 以下輸入正文
%\setcounter{chapter}{0}

\chapter{Topological Spaces}

In the language of calculus, we defined convergence, continuity and such concepts on the real numbers $\R$. We would like to generalize this concept.

\section{Metric Spaces}

\begin{df}
    A metric space is a nonempty set $M$, together with a metric $d : M\times M\to \R$. $d(x, y)$ is a real number defined for all $x, y\in M$, which can be thought of as the distance between $x$ and $y$. $d$ satisfies the following properties:
    \begin{enumerate}[label={\alph*)}]
        \item (Positive definiteness) $d(x, y) \geq 0$, and $d(x, y) = 0$ iff $x = y$.
        \item (Symmetry) $d(x, y) = d(y, x)$.
        \item (Triangle inequality) $d(x, z) \leq d(x, y) + d(y, z)$.
    \end{enumerate}
    We say that the pair $(M, d)$ is a metric space. The metric $d$ can be omitted if it is clear from the context.
\end{df}

\begin{ex}
    The following are some examples of metric spaces:
    \begin{itemize}
        \item $(\R, d)$, where $d(x, y) = |x - y|$.
        \item $(\R^n, d)$, where
        \[
        d(\mathbf x, \mathbf y) = \sqrt{(x_1 - y_1)^2 + \cdots + (x_n + y_n)^2}.
        \]
        \item $(M, d)$, where $M\neq\emptyset$, and
        \[
        d(x, y) = \begin{cases}
            0, \quad \text{if } x = y, \\
            1, \quad \text{if } x \neq y.
        \end{cases}
        \]
        This metric is called the \textbf{discrete metric} on $M$.
    \end{itemize}
\end{ex}

If $\emptyset \neq A \subseteq M$, and if $M$ is a metric, then $(A, d)$ is also a metric space. We call $A$ a metric subspace of $M$, or $A$ inherits its metric from $M$.

\begin{df}
    We say that a sequence $(x_n)$ in $M$ converges to the limit $x$ in $M$ if for any given $\epsilon > 0$, $\exists N \in \N$ such that $n\geq N$ and $n \in \N$ implies $d(x_n, x) < \epsilon$.
\end{df}

It's easy to check that limits are unique. Also, every subsequence of a convergent sequence converges, and it converges to the same limit as the original sequence.

\section{Continuity}

\begin{df}
    Let $(M, d_M)$ and $(N, d_N)$ be metric spaces. We say that $f: M\to N$ is continuous if it preserves sequential convergence, i.e. for each $(x_n)$ in $M$ which converges to $x$ in $M$, the image sequence $(f(x_n))$ converges to $f(x)$.
\end{df}

\begin{prop}
    Composition of continuous functions is continuous
    \begin{proof}
        Let $M, N, P$ be metric spaces, and let $f: M\to N$, $g: N\to P$ be continuous functions.
        
        Let $(x_n)$ be a convergent sequence in $M$ with limit $x$. We have
        \[
        \lim_{n\to\infty} x_n = x \xRightarrow{f\text{ conti.}} \lim_{n\to\infty} f(x_n) = f(x) \xRightarrow{g\text{ conti.}} \lim_{n\to\infty} g(f(x_n)) = g(f(x)),
        \]
        thus $g\circ f$ is continuous.
    \end{proof}
\end{prop}

\begin{ex}
    The following are some examples of continuous functions:
    \begin{itemize}
        \item The identity map $~id : M\to M$ is continuous.
        \item Every constant function $f: M\to N$ is continuous.
        \item Every function $f: M\to N$ is continuous if $M$ is equipped with the discrete metric.
    \end{itemize}
\end{ex}

\begin{df}
    If $f: M\to N$ is a bijection such that $f$ and $f^{-1}: N\to M$ are continuous, then we say that $f$ is a homeomorphism. If there exists a homeomorphism between $M$ and $N$, we say that $M, N$ are homeomorphic, denoted by $M\cong N$.
\end{df}

Intuitively, a homeomorphism is a bijection that can bend, twist, stretch the space $M$ to make it coincide with $N$, but it cannot rip, puncture or shred $M$ etc.

\begin{ex}
    Let $\mathbb S^1$ be the unit circle in the plane. Consider the interval $[0, 2\pi)$. Define $f: [0, 2\pi) \to \mathbb S^1$ to be the function $f(\theta) = (\cos\theta, \sin\theta)$. $f$ is continuous and bijective, but $f^{-1}$ is not continuous (consider a sequence in $\mathbb S^1$ approaching $(1, 0)$ from the lower plane).
\end{ex}

\begin{prop}
    $f: M\to N$ is continuous iff it satisfies the following: $\forall \epsilon$ and $x\in M$, $\exists \delta > 0$ such that if $y\in M$ and $d_M(x, y) < \delta$ then $d_N(f(x), f(y)) < \epsilon$.
    \begin{proof}
        "$\implies$": Suppose that $f$ fails to satisfy the $\epsilon$-$\delta$ condition at some $x\in M$. $\exists \epsilon > 0$ such that $\forall \delta > 0$, $\exists y\in M$ such that $d_M(x, y) < \delta$ but $d_N(f(x), f(y)) \geq \epsilon$. Take $\delta = \frac 1n$. By our assumption, we can obtain a sequence $(y_n)$ with $d_M(x, y_n) < \frac 1n$ but $d_N(f(x), f(y_n)) \geq \epsilon$, so $(y_n)$ converges to $x$ but $f(y_n)$ does not approach $f(x)$, contradicting the continuity of $f$.

        "$\impliedby$": Suppose that $f$ satisfies the $\epsilon$-$\delta$ condition at $x$. Let $(x_n)$ be a sequence in $M$ susch that $(x_n)$ converges to $x$. Let $\epsilon > 0$. $\exists \delta > 0$ such that $d_M(x, y) < \delta \implies d_N(f(x), f(y)) < \epsilon$. Since $(x_n)$ approaches $x$, $\exists K \in \N$ such that if $n\geq K$, then $d_M(x_n, x) < \delta$, hence $d_N(f(x_n), f(x)) < \epsilon$ for all $n\geq K$. That is, $(f(x_n))$ converges to $f(x)$.
    \end{proof}
\end{prop}

\section{The Topology of a Metric Space}

\begin{df}
    Let $M$ be a metric space, $S\subseteq M$.
    \begin{itemize}
        \item We say $S$ is open if for each $x\in S$, $\exists r > 0$ such that $d(x, y) < r$ implies $y\in S$.
        \item We say $S$ is closed if its complement is open.
        \item We say that a point $x\in M$ is a limit of $S$ if there exists a sequence in $S$ that converges to $x$.
    \end{itemize}
\end{df}

\begin{prop}
    A set $S\subseteq M$ is closed iff it contains all its limits.
    \begin{proof}
        "$\implies$": Suppose that $S$ is closed. Let $(x_n)$ be a sequence in $S$ such that $(x_n)$ converges to $x$, $x\in M$. Suppose $x\notin S$, then since $S^c$ is open, $\exists r>0$ such that $d(x, y) < r$ implies $y\in S^c$. Since $(x_n)$ converges to $x$, we have $d(x_n, x) < r$ for all $n$ large enough, implying that $x_n \in S^c$, contradiction. Therefore, for any limit point $x$ of $S$, $x\in S$.

        "$\impliedby$": Suppose that $S$ contains all its limits. If $S^c$ is not open, then $\exists x \in S^c$ such that $\forall n\in \N$, $\exists x_n\in (S^c)^c = S$ such that $d(x, x_n) < \frac1n$. We have now constructed q sequence $(x_n)$ in $S$, but converges to a point in $S^c$, contradiction. Thus $S^c$ is open, i.e. $S$ is closed.
    \end{proof}
\end{prop}

\begin{rmk}
    Sets can be neither open nor closed, or they can also be both open and closed.
\end{rmk}

\begin{df}
    The topology $\mathcal T$ of $M$ is the collection of all open subsets of $M$.
\end{df}

\begin{prop}
    $\mathcal T$ is closed under arbitrary union, finite intersection, and $\mathcal T$ contains $\emptyset$ and $M$.

    \begin{proof}
        Clearly, $\emptyset$ and $M$ are open.

        Let $(\mathcal U_\alpha)$ be a collection of open subsets of $M$. Define $V = \bigcup_\alpha \mathcal U_\alpha$. For any $x\in V$, $x\in \mathcal U_\alpha$ for some $\alpha$. Since $\mathcal U_\alpha$ is open, $\exists r>0$ such that $d(x, y)<r \implies y\in \mathcal U_\alpha \subseteq V$, so $V$ is open.

        Define $W = \bigcap_{i=1}^n \mathcal U_i$. Given $x\in W$, for each $1\leq i\leq n$, $\exists r_i > 0$ such that $d(x, y) < r_i \implies y\in \mathcal U_i$. Take $r = \min{r_1, \ldots, r_n}$, then for any $y$ satisfying $d(x, y) < r$, we have $y\in \mathcal U_i$ for all $1\leq i\leq n$, thus $y\in W$. Hence $W$ is open.
    \end{proof}
\end{prop}

\begin{df}
    Let $X$ be a set. A topology $\mathcal T$ of $X$ is a collection of subsets of $X$ that satisfies the following:
    \begin{enumerate}[label={\alph*)}]
        \item $\mathcal T$ is closed under arbitrary union,
        \item $\mathcal T$ is closed under finite intersection, and
        \item $\emptyset, X \in \mathcal T$.
    \end{enumerate}
    We say that  $(X, \mathcal T)$ is a topological space if $\mathcal T$ is a topology of $X$. The elements of $\mathcal T$ are called open sets. We define $S\subseteq X$ to be closed if $S^c$ is open.
\end{df}

\begin{ex}
    The following are some examples of topological spaces:
    \begin{itemize}
        \item A metric space is a topological space.
        \item Let $X$ be a set, and $\mathcal T = \{\emptyset, X\}$. Then $(X, \mathcal T)$ is a topological space, which is know as the trivial topology.
        \item Let $X$ be a set, and let $\mathcal T$ be the power set of $X$, then $(X, \mathcal T)$ is a topological space, which is known as the discrete topology.
    \end{itemize}
\end{ex}

\begin{rmk}
    By De Morgan's law, closed sets are closed under arbitrary intersection and finite union, also $\emptyset, X$ are closed.

    In general, infinite union of closed sets may not be closed.
\end{rmk}

\begin{df}
    Let $M$ be a metric space and $S\subseteq M$. Define
    \[
    \Bar S := \{x\in M \mid x\text{ is a limit of }S\}
    \]
    to be the closure of $S$.
    For $x\in M$, $r > 0$, define
    \[
    B(x, r) := \{y\in M\mid d(x, y) < r\},
    \]
    which is the ball centered at $x$ with radius $r$, or the $r$-neighborhood of $x$.
\end{df}

\begin{prop}
    $\Bar S$ is closed and $B(x, r)$ is open.

    \begin{proof}
        If $S = \emptyset$, then $\Bar S = \emptyset$, which is closed.

        Suppose that $S\neq \emptyset$, and let $(x_n) \to x$ be a convergence sequence in $\Bar S$. We wish to prove that $x\in \Bar S$, i.e. there exists a sequence in $S$ that approaches $x$. Since $x_n\in \Bar S$, there exists sequence $(x_{n, k})$ in $S$ that approaches $x_n$ as $k\to \infty$. For each $n$, there exists a term $x_{n, k_n}$ satisfying $d(x_{n, k_n}, x_n) < \frac1n$, picking these terms forms a new sequence $(x_{n, k_n})$, moreover, 
        \[
        d(x_{n, k_n}, x) \leq d(x_{n, k_n}, x_n) + d(x_n, x) < \frac1n + d(x_n, x),
        \]
        which approaches $0$ as $n\to\infty$, thus $(x_{n, k_n})$ approaches $x$.

        Fix $x\in M$ and $r > 0$. Let $y \in B(x, r)$ and pick $s = r - d(x, y)$. If $z$ satisfies $d(y, z) < s$, then
        \[
        d(x, z) \leq d(x, y) + d(y, z) < d(x, y) + s = r \implies B(y, s) \subseteq B(x, r),
        \]
        so $B(x, r)$ is open.
    \end{proof}
\end{prop}

\begin{cl}
    \label{cl:smallest-closed-set}
    $\Bar S$ is the smallest closed set that conatins $S$, i.e. if $K\supseteq S$ and $K$ is closed then $K\supseteq \Bar S$.

    \begin{proof}
        $K$ contains the limit of each sequence in $K$, in particular $S\subseteq K$ so it contains all sequence in $S$ that converges in $M$, but these are precisely $\Bar S$.
    \end{proof}
\end{cl}

With the observation from Corollary \ref{cl:smallest-closed-set}, we may define the closure for topological spaces in general.

\begin{df}
    Lex $X$ be a topological space, and let $S\subseteq X$. We define $\overline S$ to be the smallest closed set that contains $S$. $\Bar S$ always exists; take
    \[
    \Bar S = \bigcap\set{E\subseteq X \mid E \text{ is closed in }X\text{ and }E\supseteq S}.
    \]
    Likewise, we also define the interior of $S$, $~int (S)$, to be the largest open set contained in $S$
\end{df}

\begin{df}
    Let $X$ be a topological space, $x\in X$. A neighborhood of $x$ is an open set containing $x$.
\end{df}

\begin{df}
    Lex $X$ be a topological space and let $(x_n)$ be a sequence in $X$. We say that $(x_n)$ converges to $x\in X$ if for all neighborhood $\mathcal U$ of $x$, $\exists N\in \N$ such that $x_n \in \mathcal U$ for all $n\geq N$.
\end{df}

\begin{ex}
    Limits in general are not unique in topological spaces. Let $X$ be a set with at least $2$ points endowed with the trivial topology. Then every sequence in $X$ converges to every point in $X$.
\end{ex}

\begin{df}
    Let $X, Y$ be topological spaces. We say a function $f: X\to Y$ continuous if for any open set $V\subseteq Y$, the preimage $f^{-1}(Y)$ is open in $X$.
\end{df}

\begin{prop}
    A function $f: X\to Y$ is continuous iff $\forall x\in M$ and any neighborhood $\mathcal V$ of $f(x)$, $\exists$ a neighborhood $\mathcal U$ of $x$ such that $f(\mathcal U) \subseteq \mathcal V$.
    \begin{proof}
        "$\implies$": Let $\mathcal V\subseteq Y$ is open. We need to show $f^{-1}(Y)$ is open. Let $x\in f^{-1}(\mathcal V)$, then $f(x) \in \mathcal V$. By definition, $\exists$ a neighborhood $\mathcal U_x$ such that $f(\mathcal U_x) \subseteq \mathcal V \leadsto \mathcal U_x \subseteq f^{-1}(\mathcal V)$. Take the union of all such $\mathcal U_x$ over $x\in f^{-1}(\mathcal V)$, then
        \begin{gather*}
            \bigcup_{x\in f^{-1}(\mathcal V)} \mathcal U_x \subseteq f^{-1}(\mathcal V) \quad\text{and}\quad \forall x \in f^{-1}(\mathcal V),\, x\in \mathcal U_x \subseteq f^{-1}(\mathcal V) \\
            \implies f^{-1}(\mathcal V) = \bigcup_{x\in f^{-1}(\mathcal V)} \mathcal U_x
        \end{gather*}
        and thus $f^{-1}(\mathcal V)$ is open.

        "$\impliedby$": Let $x\in X$ and let $\mathcal V$ be a neighborhood of $f(x)$. By definition $x\in f^{-1}(\mathcal V)$, which is an open set by assumption. Also, $f(f^{-1}(\mathcal V)) \subseteq \mathcal V$, hence $f^{-1}(\mathcal V)$ is a neighborhood of $x$ such that $f(f^{-1}(\mathcal V)) \subseteq \mathcal V$.
    \end{proof}
\end{prop}

\begin{df}
    A homeomorphism is a continuous bijection between topoloical spaces.
\end{df}

\begin{cl}
    A homeomorphism $f: X \to Y$ bijects the corresponding topologies $\mathcal T_X$ and $\mathcal T_Y$.
\end{cl}

\section{Hausdorff Space}

\begin{df}
    A topological space $X$ is said to be Hausdorff if given any pair of distinct paints $x_1, x_2 \in X$, $\exists$ neighborhoods $\mathcal U_1$ of $x_1$ and $\mathcal U_2$ of $x_2$ such that $\mathcal U_1 \cap \mathcal U_2 = \emptyset$.
\end{df}

A metric space is always a Hausdorff space.

\begin{lm}
    Let $X$ be Hausdorff.
    \begin{enumerate}[label={\alph*)}]
        \item Every one-point set is closed.
        \item If a sequence $(x_n)$ in $X$ converges, then the limit is unique.
    \end{enumerate}
    \begin{proof}
        \begin{enumerate}[label={\alph*)}]
            \item Pick $x\in X$. For any $y$ distinct from $x$, there exists disjoint neighborhoods $\mathcal U_x$ of $x$ and $\mathcal V_y$ of $y$. We have
            \[
            \set{x}^c = \bigcup_{y\in X\setminus \set{x}} \mathcal V_y
            \]
            which is an open set.

            \item 
            Suppose that $x, x'$ are distinct limits of $(x_n)$. $\exists$ disjoint neighborhoods $\mathcal U$ of $x$ and $\mathcal U'$ of $x'$. $\exists N, N'\in \N$ such that "$n\geq N'$ implies $x_n\in \mathcal U$" and "$n\geq N'$ implies $x_n \in \mathcal U'$". If $n\geq \max(N, N')$, then $x_n \in \mathcal U \cap \mathcal U' = \emptyset$, contradiction. Therefore, any converging sequence has a unique limit. 
        \end{enumerate}
    \end{proof}
\end{lm}

\section{Subspaces and Product Spaces}

\begin{df}
    Let $X$ be a topological space, let $A\subseteq X$. We define the subspace topology $\mathcal T_A$ of $A$ by
    \[
    \mathcal T_A = \set{\mathcal U\subseteq A\mid \mathcal U = A\cap \mathcal V \text{ for some open }\mathcal V\subseteq X}.
    \]
\end{df}

\begin{rmk}
    Openness and closedness are not just properties of a set itself, but rather a set in a relation to a particular topological space.
\end{rmk}

\begin{prop}
    Let $M$ be a metric space, and let $N\subseteq M$ be a nonempty subset. The subspace topology on $N$ is the same as the metric topology obtained by restricting the metric of $M$ to $N$.
    \begin{proof}
        Suppose that $\mathcal V$ is an open set in $M$ and let $\mathcal U = N\cap \mathcal V \in \mathcal T_N$. 
        
        We first to prove that $\mathcal U$ belongs to the metric toplogy of $N$. Let $x\in \mathcal U$. Since $x\in N\cap \mathcal V \subseteq \mathcal V$, there exists $r > 0$ such that $B_M(x, r)\subseteq \mathcal V$, and
        \[
        B_N(x, r) = N\cap B_M(x, r) \subseteq N\cap \mathcal V = \mathcal U,
        \]
        hence $\mathcal U$ is open in $N$ (in the metric topology).

        Conversely, let $\mathcal U$ be an open set in the metric topology of $N$. $\forall x\in \mathcal U$, $\exists r_x > 0$ such that $B_N(x, r_x) \subseteq \mathcal U$. Note that
        \[
        \mathcal U = \bigcup_{x\in\mathcal U} B_N(x, r_x) = \bigcup_{x\in\mathcal U} N \cap B_M(x, r_x) = N\cap \bigcup_{x\in\mathcal U} B_M(x, r_x),
        \]
        hence $\mathcal U$ belongs to the subspace topology of $N$.
    \end{proof}
\end{prop}

\begin{df}
    Let $X$ be a set. A basis in $X$ is a collection $\mathcal B$ of subsets of $X$ satsifying
    \begin{enumerate}[label={\alph*)}]
        \item Every element of $X$ is in some element in $\mathcal B$. That is,
        \[
        X = \bigcup_{B\in \mathcal B} B.
        \]
        \item If $B_1, B_2 \in \mathcal B$ and $x\in B_1 \cap B_2$, there exists $B_3 \in \mathcal B$ such that $x\in B_3 \subseteq B_1\cap B_2$.
    \end{enumerate}
\end{df}

\begin{df}
    Given $X$ and a collection $\mathcal B$ of subsets of $X$, we say that $\mathcal U\subseteq X$ satisfies the basis criterion with respect to $\mathcal B$ if $\forall x \in \mathcal U$, $\exists B \in \mathcal B$ such that $x\in B\subseteq \mathcal U$
\end{df}

\begin{lm}
    Suppose that $\mathcal B$ is a basis in $X$, and let $\mathcal T$ be the collection of all unions of elements of $\mathcal B$. Then $\mathcal T$ is precisely the collection of all subsets of $X$ that satisfy the basis criterion w.r.t. $\mathcal B$.
    \begin{proof}
        Let $\mathcal U\subseteq X$. Suppose that $\mathcal U$ satisfies the basis criterion. Let
        \[
        \mathcal V = \bigcup\set{B\in\mathcal B\mid B\subseteq\mathcal U},
        \]
        then $\mathcal V \in \mathcal T$. We want to show that $\mathcal U = \mathcal V$. Clearly, $\mathcal V\subseteq \mathcal U$. Let $x\in \mathcal U$. Since $\mathcal U$ satisfies the basis criterion, $\exists B\in\mathcal B$ such that $x\in B\subseteq \mathcal U$, so $x\in \mathcal V$, therefore $\mathcal U\subseteq \mathcal V$.

        Conversely, suppose that $\mathcal U\in \mathcal T$, then $\mathcal U$ is a union of elements of $\mathcal B$, say $\mathcal U = \bigcup_{B\in\mathcal A}B$ where $\mathcal A\subseteq \mathcal B$. For any $x\in\mathcal U$, $x\in B$ for some $B\in \mathcal A$, also $B\subseteq \mathcal U$, so $\mathcal U$ satisfies the basis criterion.
    \end{proof}
\end{lm}

\begin{prop}
    Let $\mathcal B$ be a basis in $X$, and let $\mathcal T$ be collection of all unions of elements of $\mathcal B$. Then $\mathcal T$ is a topology on $X$. This is called the topology generated by $\mathcal B$.
    \begin{proof}
        First of all, $\emptyset = \bigcup_{B\in\emptyset} B \in \mathcal T$ and $X = \bigcup_{B\in\mathcal B} B \in \mathcal T$.

        Let $(\mathcal U_\alpha)$ be a collection of elements in $\mathcal T$, then the union $\mathcal U = \bigcup_\alpha \mathcal U_\alpha$ is also a union of elements in $\mathcal B$, hence $\mathcal U\in \mathcal T$.

        Let $\mathcal U_1, \mathcal U_2 \in \mathcal T$. For any $x\in \mathcal U_1 \cap \mathcal U_2$, since $\mathcal U_1, \mathcal U_2$ satisfy the basis criterion, $\exists B_1, B_2 \in \mathcal B$ such that $x\in B_1\subseteq \mathcal U_1$ and $x\in B_2\subseteq \mathcal U_2$. By the definition of basis, $\exists B_3\in \mathcal B$ such that $x\in B_3 \subseteq B_1\cap B_2 \subseteq \mathcal U_1 \cap \mathcal U_2$. Therefore, $\mathcal U_1 \cap \mathcal U_2$ satisfies the basis criterion w.r.t. $\mathcal B$, hence $\mathcal U_1 \cap \mathcal U_2 \in \mathcal T$.
    \end{proof}
\end{prop}

Now, we can define product topology.

\begin{df}
    Let $X_1, \ldots, X_n$ be topological spaces. Define a basis in $X_1 \times \cdots \times X_n$ by
    \[
    \mathcal B = \set{\mathcal U_1 \times \cdots \times \mathcal U_n \mid \mathcal U_i \text{ is open in }X_i,\, 1\leq i\leq n}.
    \]
    The product topology on $X_1 \times \cdots \times X_n$ is the topology generated by $\mathcal B$.
\end{df}

\begin{prop}
    If $X_1, \ldots, X_n, Y_1, \ldots, Y_n$ are topological spaces, and if $f_i: X_i \to Y_i$ are continuous functions for $1\leq i\leq n$, then the function
    \[
    f: X_1 \times \cdots \times X_n \to Y_1 \times \cdots \times Y_n, \quad f(x_1, \ldots, x_n) = (f_1(x_1), \ldots, f_n(x_n))
    \]
    is continuous.
    \begin{proof}
        We first prove that if the preimages of basis elements are open, then $f$ is continuous. Let $\mathcal U$ be an open set in $Y_1 \times \cdots \times Y_n$. By definition, $\mathcal U$ is a union of basis elements, say $\mathcal U = \bigcup_\alpha \mathcal V_\alpha$, where each $\mathcal V_\alpha$ is a basis element. We have
        \[
        f^{-1}(\mathcal U) = f^{-1}\left(\bigcup_\alpha \mathcal V_\alpha\right) = \bigcup_\alpha f^{-1}(\mathcal V_\alpha),
        \]
        which is open if each $f^{-1}(\mathcal V_\alpha)$ is open.

        Let $\mathcal V = \mathcal V_1 \times \cdots \times \mathcal V_n$ be a basis element in $Y_1 \times \cdots \times Y_n$, where $\mathcal V_i$ is open in $Y_i$. Then
        \[
        f^{-1}(\mathcal V) = f^{-1}(\mathcal V_1 \times \cdots \times \mathcal V_n) = f_1^{-1}(\mathcal V_1) \times \cdots \times f_n^{-1}(\mathcal V_n),
        \]
        which is a basis element in $X_1 \times \cdots \times X_n$ since each $f_i$ is continuous. Therefore, $f$ is continuous.
    \end{proof}
\end{prop}

\begin{df}
    Let $(M, d_M), (N, d_N)$ be metric spaces. Define the $p$-metric on $M\times N$ by
    \[
    d_p((x_1, y_1), (x_2, y_2)) = \left(d_M(x_1, x_2)^p + d_N(y_1, y_2)^p\right)^{\frac1p}, \quad 1\leq p < \infty,
    \]
    and the $\infty$-metric by
    \[
    d_\infty((x_1, y_1), (x_2, y_2)) = \max\set{d_M(x_1, x_2), d_N(y_1, y_2)}.
    \]
\end{df}

\begin{prop}
    The following properties hold for metric spaces $M, N$:
    \begin{itemize}
        \item $d_\infty \leq d_p \leq 2^{\frac1p}d_\infty$
        \item The metric topologies induced by $d_p$ and $d_\infty$ are the same.
        \item The metric topology coincides with the product topology.
    \end{itemize}
\end{prop}

\begin{prop}
    Let $M$ be a metric space, then the metric $d : M\times M \to \R$ is continuous.
    \begin{proof}
        We use the metric $d_1$ on $M\times M$.

        Let $(x_1, y_1), (x_2, y_2) \in M\times M$. We have
        \begin{align*}
            |d(x_1, y_1) - d(x_2, y_2)| &\leq |d(x_1, y_1) - d(x_1, y_2)| + |d(x_1, y_2) - d(x_2, y_2)| \\
            &\leq d(y_1, y_2) + d(x_1, x_2).
        \end{align*}
        Given $\epsilon > 0$, take $\delta = \frac\epsilon2$. If $d_1(x_1, y_1), d_1(x_2, y_2) < \delta$, then
        \[
        |d(x_1, y_1) - d(x_2, y_2)| < 2\delta = \epsilon,
        \]
        hence $d$ is continuous.
    \end{proof}
\end{prop}

So far, we've defined product topology for finite products. We can also define product topology for infinite products.

\begin{df}
    Let $(X_i, \mathcal T_i)$ be topological spaces for $i\in I$, where $I$ is an index set. We define the box topology on $\prod_{i\in I} X_i$ to be the topology generated by the basis
    \[
    \mathcal B = \set{\prod_{i\in I} \mathcal U_i \mid \mathcal U_i \text{ is open in }X_i,\, i\in I}.
    \]
    The product topology on $\prod_{i\in I} X_i$ is the topology generated by the basis
    \[
    \mathcal B' = \set{\prod_{i\in I} \mathcal U_i \mid \mathcal U_i \text{ is open in }X_i,\, \mathcal U_i = X_i \text{ for all but finitely many }i}.
    \]
\end{df}

\begin{rmk}
    For finite products, the box topology and the product topology coincide. However, for infinite products, the box topology is strictly finer than the product topology, i.e. every open set in the product topology is also open in the box topology, but not vice versa.
\end{rmk}

We will prefer the product topology over the box topology, because a number of important theorems about finite products still hold for infinite products under the product topology.

\begin{ex}
    Let $\R^\omega = \prod_{n\in\N} \R$. Consider the function
    \[
    f: \R \to \R^\omega, \quad f(x) = (x, x, x, \ldots).
    \]
    $f$ is continuous under the product topology, but not continuous under the box topology. To see this, let $\mathcal U = \prod_{n\in\N} (-\frac1n, \frac1n)$, which is open in the box topology. We have
    \[
    f^{-1}(\mathcal U) = \bigcap_{n\in\N} \left(-\frac1n, \frac1n\right) = \set{0},
    \]
    which is not open in $\R$.
\end{ex}

\section{Completion}

\begin{df}
    A sequence $(x_n)$ in a metric space $M$ is called a Cauchy sequence if $\forall \epsilon > 0$, $\exists N\in \N$ such that $m, n \geq N$ implies $d(x_n, x_m) < \epsilon$.
\end{df}

Every convergent sequence is a Cauchy sequence. The converse is not true in general, e.g. in $\Q$.

\begin{df}
    A metric space $M$ is said to be complete if every Cauchy sequence in $M$ converges to a point in $M$.
\end{df}

Completeness is not a topological property, i.e. two homeomorphic metric spaces may not be both complete or both incomplete.

\begin{ex}
    Define two metric on $\N$ by
    \[
    d_1(m, n) = |m - n|, \quad d_2(m, n) = \abs{\frac1m - \frac1n}.
    \]
    We can verify that $(\N, d_1)$ and $(\N, d_2)$ are homeomorphic, and $(\N, d_1)$ is complete. 
    However, $(\N, d_2)$ is not complete since the sequence $(n)$ is Cauchy but does not converge in $\N$.
\end{ex}

\begin{prop}
    Every closed subset of a complete metric space is a complete metric subspace.
\end{prop}

\begin{cl}
    Every closed subset of the Euclidean space $\R^n$ is a complete metric subspace.
\end{cl}

\begin{thm}
    Every metric space can be completed. That is, a metric space $M$ is always a metric subspace of a complete metric space $\Hat M$.
    \begin{proof}
        Let $\mathcal C$ be the collection of all Cauchy sequences in $M$. Define a relation $\sim$ on $\mathcal C$ by
        \[
        (x_n) \sim (y_n) \iff \lim_{n\to\infty} d(x_n, y_n) = 0.
        \]
        We can verify that $\sim$ is an equivalence relation. Let $\Hat M = \mathcal C/\sim$, and denote the equivalence class of $(x_n)$ by $[(x_n)]$. Define a metric $D$ on $\Hat M$ by
        \[
        D(X, Y) = \lim_{n\to\infty} d(x_n, y_n), 
        \]
        where $X = [(x_n)], Y = [(y_n)]$. 
        
        We first verify that $D$ is well-defined and is a metric on $\Hat M$. By triangle inequality, 
        \begin{align*}
        |d(x_n, y_n) - d(x_m, y_m)| &\leq |d(x_n, y_n) - d(x_m, y_n)| + |d(x_m, y_n) - d(x_m, y_m)| \\
        &\leq d(x_n, x_m) + d(y_n, y_m),
        \end{align*}
        and since $(x_n), (y_n)$ are Cauchy sequences, $\forall \epsilon > 0$, $\exists N\in \N$ such that $m, n \geq N$ implies $|d(x_n, y_n) - d(x_m, y_m)| < \epsilon$, hence $(d(x_n, y_n))$ is a Cauchy sequence in $\R$, which converges to a limit in $\R$. Now consider another representative $(x_n'), (y_n')$ of $X, Y$ respectively, and let
        \[
        L = \lim_{n\to\infty} d(x_n, y_n), \quad L' = \lim_{n\to\infty} d(x_n', y_n').
        \]
        By triangle inequality again, we have
        \begin{align*}
            |d(x_n, y_n) - d(x_n', y_n')| &\leq |d(x_n, y_n) - d(x_n', y_n)| + |d(x_n', y_n) - d(x_n', y_n')| \\
            &\leq d(x_n, x_n') + d(y_n, y_n').
        \end{align*}
        Since $(x_n) \sim (x_n')$ and $(y_n) \sim (y_n')$, $\forall \epsilon > 0$, $\exists N\in \N$ such that $n\geq N$ implies $|d(x_n, y_n) - d(x_n', y_n')| < \epsilon$, hence $L = L'$. Therefore, $D$ is well-defined.

        It is clear that $D(X, Y) \geq 0$ and $D(X, Y) = D(Y, X)$. If $D(X, Y) = 0$, then $d(x_n, y_n) \to 0$, so $(x_n) \sim (y_n)$, i.e. $X = Y$. Conversely, if $X = Y$, then $(x_n) \sim (y_n)$, hence $D(X, Y) = 0$. Finally, for any $X = [(x_n)], Y = [(y_n)], Z = [(z_n)] \in \Hat M$, by triangle inequality,
        \[
        D(X, Z) = \lim_{n\to\infty} d(x_n, z_n) \leq \lim_{n\to\infty} d(x_n, y_n) + \lim_{n\to\infty} d(y_n, z_n) = D(X, Y) + D(Y, Z).
        \]
        Therefore, $D$ is a metric on $\Hat M$.

        For each $x\in M$, define
        \[
        \Bar x = (x, x, x, \ldots) \in \mathcal C,
        \]
        then $\Bar x$ is a Cauchy sequence, and $D(\Bar x, \Bar y) = d(x, y)$ for any $x, y\in M$. It is clear that the mapping $x\mapsto \Bar x$ is an isometric embedding of $M$ into $\Hat M$, so we may identify $M$ as a metric subspace of $\Hat M$.

        Finally, we need to show that $\Hat M$ is complete. Let $(X_n)$ be a Cauchy sequence in $\Hat M$, where $X_n = [(x_{n, k})]$. We need to find $Y\in \Hat M$ such that $X_n \to Y$.
        
        Note that if $(x_n)$ is Cauchy in $M$, then any subsequence is equivalent to $(x_n)$, hence WLOG we can assume that $d(x_{n, k}, x_{n, l}) < 1/n$ for all $k, l \geq N$. 
        
        Set $y_n = x_{n, n}$. Let $\epsilon > 0$. Pick $N\in \N$ such that $N \geq 3/\epsilon$ and $m, n \geq N$ implies $D(X_n, X_m) < \epsilon/3$, hence
        \begin{align*}
            d(y_m, y_n) &= d(x_{m, m}, x_{n, n}) \\
            &\leq d(x_{m, m}, x_{m, k}) + d(x_{m, k}, x_{n, k}) + d(x_{n, k}, x_{n, n}) \\
            &< \frac1m + d(x_{m, k}, x_{n, k}) + \frac1n < \frac{2\epsilon}3 + d(x_{m, k}, x_{n, k}).
        \end{align*}
        As $n$ approaches infinity, $d(x_{m, k}, x_{n, k})$ approaches $D(X_m, X_n) < \epsilon/3$, hence $d(y_m, y_n) < \epsilon$ for all $m, n \geq N$. Therefore, $(y_n)$ is a Cauchy sequence in $M$. 
        
        Let $Y = [(y_n)] \in \Hat M$. It remains to show that $X_n \to Y$. Given $\epsilon > 0$, pick $N\in \N$ such that $N \geq 2/\epsilon$ such that $k, n \geq N$ implies $d(y_k, y_n) < \epsilon/2$, then
        \begin{align*}
            d(x_{n, k}, y_k) &= d(x_{n, k}, x_{k, k}) \\
            &\leq d(x_{n, k}, x_{n, n}) + d(x_{n, n}, x_{k, k}) < \frac1n + d(y_n, y_k) < \frac\epsilon2 + \frac\epsilon2 = \epsilon.
        \end{align*}
        Taking $n\to\infty$, we have $D(X_n, Y) \leq \epsilon$. Therefore, $X_n \to Y$ in $\Hat M$, and $\Hat M$ is complete.
    \end{proof}
\end{thm}

We might wish to construct the real numbers $\R$ by completing the rational numbers $\Q$. However, this approach results in some sort of circular reasoning. 

We can still define concepts such as convergence and cauchy sequence, by restricting the $\epsilon$'s to rational numbers. Then we can still consider the completion $\Hat \Q$ under this definition. We wish to prove that $\Hat \Q$ is a ordered complete field.

For $X = (x_n)$ and $Y = (y_n)$ in $\Hat \Q$, define
\[
X + Y = (x_n + y_n), \quad X - Y = (x_n - y_n), \quad XY = (x_n y_n), \quad \frac X Y = \left(\frac{x_n}{y_n}\right).
\]

If $X\in \Hat \Q$ has a representation $(x_n)$ such that for some $\epsilon > 0$, $x_n \geq \epsilon$ for all $n$, then we say $X$ is positive. If $-X$ is positive, then we say $X$ is negative. Define $X < Y$ if $Y - X$ is positive.

\begin{prop}
    \label{prop:order-completion}
    For $X = [(x_n)]$ and $Y = [(y_n)]$ in $\Hat \Q$, $X < Y$ iff $\exists$ (rational) $\epsilon > 0$ and $N\in \N$ such that $y_m - x_n > \epsilon$ for all $m, n\geq N$.
\end{prop}

It remains to show that every nonempty subset of $\Hat \Q$ that is bounded above has a least upper bound. Define the least upper bound for $\mathcal A$ to be the equivalence class $Y$ of the sequence $(y_n)$, where
\begin{enumerate}
    \item $y_0$ is the smallest integer such that $[(y_0, y_0, y_0, \ldots)]$ is an upper bound for $\mathcal A$.
    \item For $n\geq 1$, $y_n$ is the smallest rational with denominator $2^n$ such that $[(y_n, y_n, y_n, \ldots)]$ is an upper bound for $\mathcal A$.
\end{enumerate}

We can check that $(y_n)$ is monotone decreasing and $y_n - y_{n+1} \leq 2^{-n}$. For $m, n\in \N$ with $m > n$, we have
\[
|y_m - y_n| \leq \sum_{j=n}^{m-1} |y_{j+1} - y_j| \leq \sum_{j=n}^{m-1} 2^{-j} < \sum_{j=n}^\infty 2^{-j} = 2^{1-n},
\]
so $(y_n)$ is Cauchy and thus in $\Hat \Q$. Now we check that $Y = \sup \mathcal A$. Suppose that $Y$ is not an upper bound for $\mathcal A$, then $\exists X = [(x_n)] \in \mathcal A$ such that $X > Y$. By Proposition \ref{prop:order-completion}, $\exists\epsilon > 0$ and $N\in \N$ such that $x_n - y_N > \epsilon$ for all $n\geq N$, then
\[
[(y_N, y_N, y_N, \ldots)] < X,
\]
contradicting the construction of $y_n$. Therefore, $Y$ is an upper bound for $\mathcal A$.

Now suppose that $Z = [(z_n)]$ is another upper bound for $\mathcal A$ such that $Z < Y$. By Proposition \ref{prop:order-completion}, $\exists \epsilon > 0$ and $N\in \N$ such that $y_m - z_n > \epsilon$ for all $m, n\geq N$. 

Pick $k\geq N$ such that $1/2^{k-1} < \epsilon$, then for all $m\geq N$, we have
\begin{gather*}
    z_m + \frac\epsilon2 < y_k - \frac\epsilon2 < y_k - \frac1{2^k} \\
    \implies Z < [(y_k - \frac1{2^k}, y_k - \frac1{2^k}, y_k - \frac1{2^k}, \ldots)],
\end{gather*}
but $y_k$ is the smallest fraction with denominator $2^k$ such that $[(y_k, y_k, y_k, \ldots)]$ is an upper bound for $\mathcal A$, contradiction. Therefore, $Y = \sup \mathcal A$.

\section{Connectedness}

\begin{df}
    If $X$ is a topological space, a separation of $X$ is a pair of disjoint nonempty open sets $U, V \subseteq X$ such that $X = U \cup V$. A topological space $X$ is connected if there does not exist a separation of $X$.
\end{df}

\begin{prop}
    A topological space $X$ is connected iff the only clopen subsets of $X$ are $\emptyset$ and $X$.
\end{prop}

\begin{prop}
    Let $X, Y$ be topological spaces and let $f: X \to Y$ be continuous. If $X$ is connected, then $f(X)$ is connected.
    \begin{proof}
        Suppose that $f(X)$ is not connected, then $\exists$ a separation $U, V$ of $f(X)$, i.e. exists nonempty open sets $U, V$ in $Y$ such that $U\cap V\cap f(X) = \emptyset$ and $U\cup V \supset f(X)$. Then $f^{-1}(U)$ and $f^{-1}(V)$ are disjoint nonempty open sets in $X$ such that $X = f^{-1}(U) \cup f^{-1}(V)$, contradicting the connectedness of $X$. Therefore, $f(X)$ is connected.
    \end{proof}
\end{prop}

\begin{cl}
    If $X$ is connected and if $X$ is homeomorphic to $Y$, then $Y$ is connected.
\end{cl}

\begin{cl}[Intermediate Value Theorem]
    Let $X$ be a connected topological space. If $f: X \to \R$ is continuous, then if $a, b \in f(X)$ and if $c$ is between $a$ and $b$, then $c \in f(X)$.
    \begin{proof}
        Suppose $f$ attains $a, b$ but does not attain $c$ such that $a < c < b$. Then
        \[
        X = \set{x\in X \mid f(x) < c} \cup \set{x\in X \mid f(x) > c}
        \]
        is a separation of $X$, contradicting the connectedness of $X$. Therefore, $c \in f(X)$.
    \end{proof}
\end{cl}

\begin{prop}
    $\R$ is connected.
    \begin{proof}
        Let $\mathcal U\subseteq \R$ be nonempty and clopen. Let $x\in \mathcal U$ and consider
        \[
        A = \set{u\in \mathcal U \mid \text{the open interval } (x, u) \subseteq \mathcal U}.
        \]
        $A$ is nonempty since $\mathcal U$ is open. Let $s = \sup A$. If $s < \infty$, then $s$ is a limit of $A$. Since $\mathcal U$ is closed and $A\subseteq \mathcal U$, $s\in \mathcal U$. Since $\mathcal U$ is open, $\exists \epsilon > 0$ such that $(s - \epsilon, s + \epsilon) \subseteq \mathcal U$, but then $(x, s + \epsilon) \subseteq \mathcal U$, contradicting the fact that $s$ is an upper bound of $A$. Therefore, $s = \infty$, and $(x, \infty) \subseteq \mathcal U$. Similarly, we can show that $(-\infty, x) \subseteq \mathcal U$. Therefore, $\mathcal U$ must equal $\R$, and $\R$ is connected.
    \end{proof}
\end{prop}

\begin{cl}
    $(a, b)$, $[a, b]$, and $\mathbb S^1$ are connected.
    \begin{proof}
        $(a, b)$ is homeomorphic to $\R$ via $f(x) = \tan(\pi(x - \frac{a+b}{2})/(b-a))$. $[a, b]$ is connected since it is the continuous image of $\R$ via
        \[
        g(x) = \begin{cases}
            a & x < 0, \\
            x & 0 \leq x \leq 1, \\
            b & x > 1.
        \end{cases}
        \]. $\mathbb S^1$ is connected since it is the continuous image of $[0, 1]$ via $h(x) = (\cos x, \sin x)$.
    \end{proof}
\end{cl}

\begin{rmk}
    $[a, b]$ is not homeomorphic to $\mathbb S^1$. Removing a point $x \in (a, b)$ disconnects $[a, b]$, but removing any point from $\mathbb S^1$ leaves it connected.
\end{rmk}

\begin{prop}
    If $X$ is a topological space and $A \subseteq X$ is connected, then the closure $\Bar A$ is connected.
    \begin{proof}
        Suppose that $\mathcal U, \mathcal V$ is a separation of $\Bar A$. If $A$ has nonempty intersection with both $\mathcal U$ and $\mathcal V$, then $A = (A \cap \mathcal U) \cup (A \cap \mathcal V)$ is a separation of $A$, contradicting the connectedness of $A$. Therefore, WLOG, $A \subseteq \mathcal U$. Each point in $V$ has a neighborhood that is disjoint from $A$ (just pick $V$), hence $V \cap \Bar A = \emptyset$, contradicting the fact that $\mathcal U, \mathcal V$ is a separation of $\Bar A$. Therefore, $\Bar A$ is connected.
    \end{proof}
\end{prop}

\begin{prop}
    The union of connected sets sharing a common point is connected.
    \begin{pf}
        Let $S = \bigcup_{\alpha \in I} S_\alpha$, where each $S_\alpha$ is connected and $x \in S_\alpha$ for all $\alpha \in I$. 
        
        Suppose that $\mathcal U, \mathcal V$ is a separation of $S$, then $x$ must be in either $\mathcal U$ or $\mathcal V$, WLOG, say $x \in \mathcal U$. Note that $\mathcal U \cap S_\alpha$ is clopen in $S_\alpha$ for all $\alpha \in I$, and it is nonempty since it contains $x$. Therefore, $\mathcal U \cap S_\alpha = S_\alpha$ for all $\alpha \in I$, hence $S \subseteq \mathcal U$, contradicting the fact that $\mathcal U, \mathcal V$ is a separation of $S$. Therefore, $S$ is connected.
    \end{pf}
\end{prop}

\begin{ex}
    The $2$-sphere $\mathbb S^2$ is connected, since it is the surface of revolution of the semicircle, which is connected. Convex subsets of $\R^n$ since it is the union of line segments sharing a common point.
\end{ex}

\begin{df}
    A path joining $x$ to $y$ in a topological space $X$ is a continuous map $f: [0, 1] \to X$ such that $f(0) = x$ and $f(1) = y$. If each pair of points in $X$ can be joined by a path, then $X$ is path-connected.
\end{df}

\begin{thm}
    A path-connected topological space is connected.
    \begin{proof}
        Suppose that $X$ is path-connected but not connected. Then $\exists$ a separation $\mathcal U, \mathcal V$ of $X$. Pick $x\in \mathcal U$ and $y\in \mathcal V$. Since $X$ is path-connected, $\exists$ a path $f: [0, 1] \to X$ such that $f(0) = x$ and $f(1) = y$. Then
        \[
        [0, 1] = f^{-1}(\mathcal U) \cup f^{-1}(\mathcal V)
        \]
        is a separation of $[0, 1]$, contradicting the connectedness of $[0, 1]$. Therefore, $X$ is connected.
    \end{proof}
\end{thm}

\begin{ex}
    $\R^n$, convex subsets of $\R^n$, and $\mathbb S^n$ are path-connected, hence connected.
\end{ex}

\begin{ex}
    Define subsets of $\R^2$ by
    \begin{gather*}
        A = \set{(x, y) \mid x = 0, y \in [-1, 1]}, \\
        B = \set{(x, y) \mid y = \sin(1/x), x \in (0, 1]}.
    \end{gather*}
    Let $X = A \cup B$. $X$ is connected since $B$ is connected and $X = \Bar B$. However, $X$ is not path-connected. 
\end{ex}

\section{Other Metric Space Concepts}

\begin{df}
    We say $x$ is an accumulation point (cluster point) of $S$ if every neighborhood of $x$ contains at least one point of $S$ different from $x$. We say $x$ is a condensation point of $S$ if every neighborhood of $x$ contains uncountably many points of $S$.
\end{df}

\begin{prop}
    Let $M$ be a metric space and let $S \subseteq M$. Then $x$ is an accumulation point of $S$ iff $\exists$ a sequence of distinct points in $S$ that converges to $x$.
    \begin{proof}
        "$\implies$": Let $x$ be an accumulation point of $S$. Pick $x_1 \in S$ such that $0 < d(x_1, x) < 1$. Set $r_2 = d(x_1, x)/2$, and choose $x_2 \in S$ such that $0 < d(x_2, x) < r_2$. Note that $x_2 \neq x_1$ since $d(x_2, x) < d(x_1, x)$. Continuing this process, we obtain a sequence of distinct points $(x_n)$ in $S$ such that $d(x_n, x) < 1/2^{n-1}$. Therefore, $x_n \to x$.

        "$\impliedby$": Let $(x_n)$ be a sequence of distinct points in $S$ such that $x_n \to x$. Then $\forall r > 0$, $\exists N \in \N$ such that $\forall n > N$, $d(x_n, x) < r$. Since $(x_n)$ are distinct points in $S$, the neighborhood $B(x, r)$ contains at least one point of $S$ different from $x$. Therefore, $x$ is an accumulation point of $S$.
    \end{proof}
\end{prop}

In the following, let $S'$ be the set of accumulation points of $S$.

\begin{prop}
    Let $X$ be a topological space and let $S \subseteq X$. Then $S \cup S' = \Bar S$. 
    \begin{proof}
        "$\subseteq$": Let $x \in S \cup S'$. If $x \in S$, then clearly $x \in \Bar S$. If $x \in S'$, then every neighborhood of $x$ contains a point of $S$ different from $x$, hence every neighborhood of $x$ intersects $S$, so $x \in \Bar S$. Therefore, $S \cup S' \subseteq \Bar S$.

        "$\supseteq$": Let $x \in \Bar S$. If $x \in S$, then $x \in S \cup S'$. If $x \notin S$, then every neighborhood of $x$ contains a point of $S$, which must be different from $x$, hence $x$ is an accumulation point of $S$, so $x \in S'$. Therefore, $x \in S \cup S'$. 
    \end{proof}
\end{prop}

\begin{cl}
    $S$ is closed iff $S' \subseteq S$.
\end{cl}

\begin{df}
    Let $X$ be a topological space. A subset $S \subseteq X$ is perfect if $S' = S$. 
\end{df}

\begin{ex}
    The closed interval $[a, b]$ is perfect in $\R$. $\Q$ is perfect in $\Q$ but not perfect in $\R$. $\N$ is not perfect in the discrete topology.
\end{ex}

\begin{thm}
    \label{thm:perfect-complete-uncountable}
    Every perfect, complete metric space is uncountable.
    \begin{proof}
        Suppose not. Let $M$ be a perfect, complete metric space that is countable. Since $M$ is a metric space and $M$ consists of accumulation points, it has to be infinite, hence countably infinite, so we can write $M = \set{x_1, x_2, \ldots}$.

        Define the closed ball
        \[
        \Bar B(x, r) = \set{y \in M \mid d(x, y) \leq r}.
        \]
        Choose any $y_1 \in M$ with $y_1 \neq x_1$ and choose $r_1 > 0$ such that $x_1 \notin \Bar B(y_1, r_1) =: Y_1$. WLOG assume $r_1 < 1$. Since $y_1$ is an accumulation point of $M$, $\exists y_2 \in M$ such that $y_2 \neq x_2$ and $y_2 \in B(y_1, r_1)$. Choose $r_2 > 0$ such that $x_2 \notin \Bar B(y_2, r_2) =: Y_2$. WLOG assume $r_2 < 1/2$ and $Y_2 \subseteq Y_1$. Continuing this process, we obtain a nested sequence of closed balls $Y_1 \supset Y_2 \supset \cdots$ such that $x_1, x_2, \ldots, x_n \notin Y_n$ and $r_n < 1/n$. Since the centers $y_n$ form a Cauchy sequence, by completeness, $y_n \to y$ for some $y \in M$. Since $y \in Y_n$ for all $n$, $y \neq x_n$ for all $n$. Therefore, $y \in M$ but $y \notin \set{x_1, x_2, \ldots}$, contradicting the fact that $M = \set{x_1, x_2, \ldots}$. Therefore, $M$ is uncountable.
    \end{proof}
\end{thm}

\begin{cl}
    $\R$ and $[a, b]$ are uncountable.
\end{cl}

\begin{cl}
    Each $r$-neighborhood of a perfect complete metric space is uncountable.
    \begin{proof}
        The closure of an open ball $\Bar{B(x, r/2)}$ is a perfect complete metric space, hence uncountable. Since $\Bar{B(x, r/2)} \subseteq B(x, r)$, $B(x, r)$ is uncountable.
    \end{proof}
\end{cl}

\chapter{Compactness}

A set $K \subseteq \R^n$ is compact if it is closed and bounded. We wish to generalize this definition to arbitrary topological spaces.

\begin{df}
    In a topological space $X$, a subset $K\subseteq X$ is sequentially compact if every sequence in $K$ has a subsequence that converges to a point in $K$.
\end{df}

\begin{prop}
    A sequentially compact subset of a metric space is closed and bounded.
    \begin{proof}
        Since every convergent sequence has its limit in $K$, $K$ is closed.

        Suppose that $K$ is unbounded. $\forall n\in \N$, $\exists x_n, y_n \in K$ such that $d(x_n, y_n) \geq n$. By sequential compactness, exists convergent subsequences $(x_{n_k})$ and $(y_{n_k})$ that converge to $x, y \in K$ respectively, then
        \[
        n_k \leq d(x_{n_k}, y_{n_k}) \leq d(x_{n_k}, x) + d(x, y) + d(y, y_{n_k}).
        \]
        As $k\to\infty$, the right hand side approaches $d(x, y)$, which is finite, but the left hand side approaches infinity, contradiction. Therefore, $K$ is bounded.
    \end{proof}
\end{prop}

\begin{rmk}
    The converse holds in $\R^n$, but not in general metric spaces. Consider
    \begin{gather*}
        C([0, 1], \R) = \set{f: [0, 1] \to \R \mid \text{$f$ is continuous}}, \\
        d(f, g) = \max\set{\abs{f(x) - g(x)} \mid x\in [0, 1]}.
    \end{gather*}
    A closed unit ball is not sequentially compact. Consider the sequence of functions $f_n(x) = x^n$. It is clear that $(f_n)$ is in the closed unit ball, but it does not have a convergent subsequence in $C([0, 1], \R)$.
\end{rmk}

In a general topological space, it is sometimes inconvenient to use sequences to describe compactness. 

\begin{df}
    An open cover of a topological space $X$ is a collection $\mathcal U$ of open sets in $X$ whose union contains $X$. A subcover of an open cover $\mathcal U$ is a subcollection of $\mathcal U$ that still covers $X$. A topological space $X$ is compact if every open cover of $X$ has a finite subcover.
\end{df}

\begin{ex}
    $(0, 1]$ is not compact in $\R$. Consider the open cover $\mathcal U = \set{(\frac1n, 2) \mid n\in \N}$, which does not have a finite subcover.
\end{ex}

In general, compactness and sequential compactness are not equivalent. However, they are equivalent in metric spaces.

We first introduce some auxiliary definitions.

\begin{df}
    A Lebesgue number for an open cover $\mathcal U$ of a subset $A$ of a metric space $M$ is a positive real number $\lambda$ such that for every $a\in A$, $\exists U \in \mathcal U$ such that $B(a, \lambda) \subseteq U$.
\end{df}

\begin{lm}[Lebesgue number lemma]
    Every open cover of a sequentially compact set (in a metric space) has a positive Lebesgue number.
    \begin{proof}
        Suppose otherwise, so that there exists some open cover $\mathcal U$ of a sequentially compact set $K$ such that $\forall \lambda > 0$, $\exists k \in K$ such that no $U\in \mathcal U$ contains $B(k, \lambda)$. 

        Take $\lambda = 1/n$ and let $k_n \in K$ be the corresponding point such that no $U\in \mathcal U$ contains $B(k_n, 1/n)$. By sequential compactness, $(k_n)$ has a convergent subsequence $(k_{n_j})$ that converges to some $x\in K$. Since $\mathcal U$ is an open cover of $K$, $\exists U \in \mathcal U$ such that $x\in U$. Since $U$ is open, $\exists r > 0$ such that $B(x, r) \subseteq U$. Pick $j$ large enough such that $1/n_j < r/2$ so that
        \[
        d(k_{n_j}, x) < r/2 \leadsto B(k_{n_j}, 1/n_j) \subseteq B(x, r) \subseteq U,
        \]
        contradicting the assumption that no $U\in \mathcal U$ contains $B(k_{n_j}, 1/n_j)$. Therefore, $\mathcal U$ has a positive Lebesgue number.
    \end{proof}
\end{lm}

If $A$ is noncompact then it may have open covers with no positive Lebesgue number. For example, consider the set $A = (0, 1) \subseteq \R$ and the open cover $\mathcal U = \set{A}$. It is clear that we cannot find $\lambda > 0$ such that $(a-\lambda, a+\lambda) \subseteq A$ for all $a\in A$.

\begin{thm}
    Let $M$ be a metric space. A subset $K\subseteq M$ is compact iff it is sequentially compact.
    \begin{proof}
        "$\implies$": If $K$ is finite then it is trivially sequentially compact (since any sequence in $K$ must contain some element infinitely many times). 
        
        Suppose that $K$ is infinite. Assume that $K$ is compact but not sequentially compact, then $\exists$ a sequence $(x_n)$ in $K$ that does not have a convergent subsequence. For each $k\in K$, $\exists$ $r_k > 0$ such that $B(k, r_k)$ contains only finitely many terms of $(x_n)$. Otherwise, if every neighborhood of $k$ contains infinitely many terms of $(x_n)$, then we can construct a subsequence of $(x_n)$ that converges to $k$. The collection $\set{B(k, r_k) \mid k\in K}$ is an open cover of $K$, hence it has a finite subcover
        \[
        \set{B(k_1, r_{k_1}), \ldots, B(k_m, r_{k_m})}.
        \]
        Each $x_n$ appears in each $B(k_i, r_{k_i})$ only finitely many times, so $(x_n)$ can only have finitely many values, but any such sequence must have a constant subsequence, which is convergent, contradiction. Therefore, $K$ is sequentially compact.

        "$\impliedby$": Let $\mathcal U$ be an open cover of $K$. By the Lebesgue number lemma, $\mathcal U$ has a positive Lebesgue number $\lambda$. Choose $x_1 \in K$, then $\exists \mathcal U_1 \in \mathcal U$ such that $B(x_1, \lambda) \subseteq \mathcal U_1$. If $K \subseteq \mathcal U_1$, then we are done. Otherwise, for any point in $K$ not covered, we can again find $x_2 \in K$ such that $x_2 \notin \mathcal U_1$, then $\exists \mathcal U_2 \in \mathcal U$ such that $B(x_2, \lambda) \subseteq \mathcal U_2$. If $K \subseteq \mathcal U_1 \cup \mathcal U_2$, then we are done. Otherwise, we can continue this process to find $x_3, x_4, \ldots$. If the process continues indefinitely, then we have constructed a sequence $(x_n)$ in $K$ such that $x_m \notin \mathcal U_n$ for all $m > n$. By sequential compactness, $(x_n)$ has a convergent subsequence $(x_{n_k})$ that converges to some $x\in K$. Then there exists a large $k$ such that $d(x_{n_k}, x) < \lambda$, which implies that $x\in B(x_{n_k}, \lambda)\subseteq \mathcal U_{n_k}$. But by construction, $x_{n_m} \notin \mathcal U_{n_k}$ for all $m > k$, contradicting the fact that $x_{n_m} \to x$. Therefore, the process must terminate within finitely many steps, and we have found a finite subcover of $\mathcal U$. Hence, $K$ is compact.
    \end{proof}
\end{thm}

\begin{cl}[Heine-Borel Theorem]
    A subset of $\R^n$ is compact iff it is closed and bounded.    
\end{cl}

\begin{df}
    A metric space is totally bounded if for every $\epsilon > 0$, the space can be covered by finitely many balls of radius $\epsilon$.
\end{df}

\begin{thm}
    A subset of a complete metric space is compact iff it is closed and totally bounded.
\end{thm}

\section{Continuity and Compactness}

\begin{prop}
    Let $X, Y$ be topological spaces and let $f: X \to Y$ be continuous. If $X$ is compact, then $f(X)$ is compact.
    \begin{proof}
        Let $\mathcal U$ be an open cover of $f(X)$, then $\mathcal V = \set{f^{-1}(U) \mid U\in \mathcal U}$ is an open cover of $X$. Since $X$ is compact, $\exists U_1, \ldots, U_n \in \mathcal U$ such that
        \[
        X \subseteq f^{-1}(U_1) \cup \cdots \cup f^{-1}(U_n) \implies f(X) \subseteq U_1 \cup \cdots \cup U_n,
        \]
        hence $f(X)$ is compact.
    \end{proof}
\end{prop}

\begin{cl}[Extreme Value Theorem]
    Let $X$ be a metric space. If $X$ is compact and if $f: X \to \R$ is continuous, then $f$ is bounded and attains its maximum and minimum.
    \begin{proof}
        Since $f(X)$ is compact in $\R$, it is closed and bounded, hence $f$ is bounded, and since $f(X)$ is closed, $\sup f(X), \inf f(X) \in f(X)$, so $f$ attains its maximum and minimum.
    \end{proof}
\end{cl}

\begin{cl}
    If $X$ is compact and if $X$ is homeomorphic to $Y$, then $Y$ is compact.
\end{cl}

\begin{cl}
    $[0, 1]$ and $\R$ are not homeomorphic.
\end{cl}

\begin{prop}
    Every continuous function defined on a compact metric space is uniformly continuous.
    \begin{proof}
        Suppose not. Let $f: M\to N$ be continuous, where $M$ is compact, but $f$ is not uniformly continuous. Then $\exists \epsilon > 0$ such that $\forall \delta > 0$, $\exists x, y \in M$ such that $d(x, y) < \delta$ but $d(f(x), f(y)) \geq \epsilon$. Take $\delta = 1/n$ and let $x_n, y_n \in M$ be the corresponding points such that $d(x_n, y_n) < 1/n$ but $d(f(x_n), f(y_n)) \geq \epsilon$. By compactness, $(x_n)$ has a convergent subsequence $(x_{n_k})$ that converges to some $x\in M$. Since $d(x_{n_k}, y_{n_k}) < 1/n_k$, we have $y_{n_k} \to x$ as well. Since $f$ is continuous, $f(x_{n_k}) \to f(x)$ and $f(y_{n_k}) \to f(x)$, contradicting the fact that $d(f(x_{n_k}), f(y_{n_k})) \geq \epsilon$. Therefore, $f$ is uniformly continuous.
    \end{proof}
\end{prop}

\section{Subspaces, Products, and Hausdorff Spaces}

\begin{prop}
    If $A$ is compact in $X$ and if $B$ is compact in $Y$, then $A \times B$ is compact in $X \times Y$.
    \begin{proof}
        Let $\mathcal U$ be an open cover of $A \times B$. For each $a\in A$, $\set{a} \times B$ is homeomorphic to $B$, hence it is compact. Therefore, $\exists U_1, U_2, \ldots, U_n \in \mathcal U$ such that
        \[
        \set{a} \times B \subseteq U_1 \cup U_2 \cup \cdots \cup U_n.
        \]
        For each $b\in B$, we can find a product open set $V\times W \subseteq X\times Y$ containing $(a, b)$. These $V\times W$ form an open cover for $\set{a} \times B$. We can extract $V_1\times W_1, \ldots, V_m\times W_m$ such that they cover $\set{a} \times B$. 

        Define $Z_a = V_1 \cap \cdots \cap V_m$, then $Z_a \times B \subseteq U_1 \cup \cdots \cup U_n$. We have shown that for any $a\in A$, $\exists$ open cover $Z_a$ such that $Z_a \times B$ is covered by finitely many open sets in $\mathcal U$. 

        Since $\{Z_a\}_{a\in A}$ is an open cover of $A$ in $X$ (each $Z_a$ is open and contains $a$), and $A$ is compact, there exist finitely many points $a_1, \ldots, a_k \in A$ such that $A \subseteq Z_{a_1} \cup \cdots \cup Z_{a_k}$. Then
        \[
        A \times B \subseteq (Z_{a_1} \times B) \cup \cdots \cup (Z_{a_k} \times B)
        \]
        and each $Z_{a_i} \times B$ is covered by finitely many sets from $\mathcal U$. Therefore, $A \times B$ is covered by finitely many sets from $\mathcal U$, so $A \times B$ is compact.
    \end{proof}
\end{prop}

\begin{prop}
    Every closed subset of a compact space is compact.
    \begin{proof}
        Let $\mathcal U$ be an open cover for $E$, then $\mathcal U \cup \set{X \setminus E}$ is an open cover for $X$. Since $X$ is compact, we can extract a finite subcover. If $X \setminus E$ is in the subcover, we can discard it since it does not cover any point in $E$. Therefore, $E$ is compact.
    \end{proof}
\end{prop}

\begin{prop}
    Every compact subset of a Hausdorff space is closed. 
    \begin{proof}
        Let $X$ be a Hausdorff space.
        \begin{clm}
            If $A, B\subseteq X$ are disjoint compact subsets, then $\exists$ disjoint open sets $U, V \subseteq X$ such that $A \subseteq U$ and $B \subseteq V$.

            \noindent\textit{Proof. }
            Suppose that $B = \set{b}$ is a singleton. $\forall a\in A$, $\exists$ disjoint open sets $\mathcal U_a$ and $\mathcal V_a$ such that $a\in \mathcal U_a$ and $b \in \mathcal V_a$. $\set{\mathcal U_a \mid a\in A}$ is an open cover for $A$, hence we can extract a finite subcover $\mathcal U_{a_1}, \ldots, \mathcal U_{a_n}$. Define
            \[
            \Tilde U = \bigcup_{i=1}^n \mathcal U_{a_i}, \quad \Tilde V = \bigcap_{i=1}^n \mathcal V_{a_i},
            \]
            then $\Tilde U$ and $\Tilde V$ are disjoint open sets such that $A \subseteq \Tilde U$ and $b \in \Tilde V$.

            For general $B$, we have shown that $\forall b\in B$, $\exists$ disjoint open sets $\Tilde U_b, \Tilde V_b$ such that $A \subseteq \Tilde U_b$ and $b \in \Tilde V_b$. $\set{\Tilde V_b \mid b\in B}$ is an open cover for $B$, hence we can extract a finite subcover $\Tilde V_{b_1}, \ldots, \Tilde V_{b_m}$. Define
            \[
            \Tilde U = \bigcap_{j=1}^m \Tilde U_{b_j}, \quad \Tilde V = \bigcup_{j=1}^m \Tilde V_{b_j},
            \]
            then $\Tilde U$ and $\Tilde V$ are disjoint open sets such that $A \subseteq \Tilde U$ and $B \subseteq \Tilde V$. $\qed$
        \end{clm}

        Now, let $K\subseteq X$ be compact. We need to show that $X \setminus K$ is open. For any $x\in X \setminus K$, $\set{x}$ and $K$ are disjoint compact subsets, hence by the claim, $\exists$ disjoint open sets $U, V \subseteq X$ such that $\set{x} \subseteq U$ and $K \subseteq V$. In other words, for all points $x \in X \setminus K$, we can find an open neighborhood $U$ of $x$ that is contained in $X \setminus K$. Therefore, $X \setminus K$ is open, and $K$ is closed.
    \end{proof}
\end{prop}

\section{Finite Intersection Property}

\begin{df}
    A collection $\mathcal C$ of subsets of $X$ is said to have the finite intersection property if the intersection of every finite subcollection of $\mathcal C$ is nonempty.
\end{df}

\begin{thm}
    \label{thm:compact-fip}
    Let $X$ be a topological space. Then $X$ is compact iff every collection $\mathcal C$ of nonempty closed sets in $X$ with the finite intersection property has a nonempty intersection.
    \begin{proof}
        Given a collection $\mathcal U$ of subsets of $X$, define
        \[
        \mathcal C = \set{X \setminus U \mid U\in \mathcal U}.
        \]
        The following statements hold:
        \begin{enumerate}
            \item $\mathcal U$ is a collection of open sets $\iff$ $\mathcal C$ is a collection of closed sets.
            \item The collection $\mathcal U$ covers $X$ $\iff$ $\bigcap_{C\in \mathcal C} C = \emptyset$.
            \item The finite subcollection $\set{U_1, \ldots, U_n}$ of $\mathcal U$ covers $X$ $\iff$ $\bigcap_{i=1}^n (X\setminus U_i) = \emptyset$.
        \end{enumerate}
        Now, if $X$ is compact, we have the contrapositive statment that given any collection $\mathcal U$ of open sets, if no finite subcollection of $\mathcal U$ covers $X$, then $\mathcal U$ does not cover $X$. This is directly equivalent to the statement we wish to prove by the above observations.
    \end{proof}
\end{thm}

\begin{cl}
    Let $X$ be a compact topological space. Suppose that $(F_n)$ is a sequence of nonempty closed subsets of $X$ that are nested decreasing, i.e. $F_{n+1} \subseteq F_n$ for all $n$. Then $\bigcap_{n=1}^\infty F_n$ is nonempty.
\end{cl}

\begin{df}
    Let $M$ be a metric space. For a subset $A \subseteq M$, the diameter of $A$ is defined to be
    \[
    \sup \set{d(x, y) \mid x, y \in A}.
    \]
\end{df}

\begin{prop}
    \label{prop:nested-closed-sets}
    If in addition to the conditions in the previous corollary, 
    \[
    \lim_{n\to\infty} ~diam (F_n) = 0,
    \]
    then $\bigcap_{n=1}^\infty F_n$ is a singleton.
    \begin{proof}
        Write $F = \bigcap_{n=1}^\infty F_n$. We have shown that $F$ is nonempty. Since $F \subseteq F_n$ for all $n$, we have $~diam (F) = 0$. If $F$ contains two distinct points $x, y$, then $d(x, y) > 0$. Therefore, $F$ must contain exactly one point. 
    \end{proof}
\end{prop}

\section{Tychonoff Theorem}

\begin{lm}
    \label{lm:tychonoff-lm1}
    Let $X$ be a set, and let $\mathcal A$ be a collection of subsets of $X$ that has the FIP. Then $\exists$ a collection $\mathcal D$ of subsets of $X$ such that $\mathcal D$ contains $\mathcal A$, $\mathcal D$ has the FIP, and $\mathcal D$ is maximal with respect to inclusion.
    \begin{proof}
        We will construct $\mathcal D$ using Zorn's lemma. Let
        \[
        \mathbb A = \set{\mathcal B \mid \mathcal B \text{ is a collection of subsets of $X$ that has the FIP and } \mathcal A \subseteq \mathcal B}.
        \]
        We need to show that every chain in $\mathbb A$ has an upper bound in $\mathbb A$. Let $\mathbb B$ be a chain in $\mathbb A$. Define
        \[
        \mathcal C = \bigcup_{\mathcal B \in \mathbb B} \mathcal B.
        \]
        Clearly $\mathcal C$ is an upper bound for $\mathbb B$ in $\mathbb A$. We need to show that $\mathcal C \in \mathbb A$. It is clear that $\mathcal A \subseteq \mathcal C$, hence it is left to show that $\mathcal C$ has the FIP. Given any finite subcollection $\mathcal C_1, \ldots, \mathcal C_n$ of $\mathcal C$, $\exists \mathcal B_1, \ldots, \mathcal B_n \in \mathbb B$ such that $\mathcal C_i \in \mathcal B_i$. Since $\mathbb B$ is a chain, there exists an element $\mathcal B_k$ that contains all $\mathcal B_i$'s, hence $\mathcal C_1, \ldots, \mathcal C_n \in \mathcal B_k$. Since $\mathcal B_k$ has the FIP, $\bigcap_{i=1}^n \mathcal C_i \neq \emptyset$. Therefore, $\mathcal C$ has the FIP, and $\mathcal C \in \mathbb A$. By Zorn's lemma, $\mathbb A$ has a maximal element $\mathcal D$, which is what we want.
    \end{proof}
\end{lm}

\begin{lm}
    \label{lm:tychonoff-lm2}
    Let $X$ be a set, and let $\mathcal D$ be a collection of subsets of $X$ that has the FIP and is maximal with respect to inclusion. Then any finite intersection of elements of $\mathcal D$ is in $\mathcal D$. Moreover, if $A \subseteq X$ intersects every element of $\mathcal D$, then $A \in \mathcal D$.
    \begin{proof}
        Let $B$ be an intersection of finitely many elements of $\mathcal D$. Since $\mathcal D$ has the FIP, $B \neq \emptyset$. Define $\mathcal E = \mathcal D \cup \set{B}$. Pick finitely elements of $\mathcal E$. If none of them is $B$, then their intersection is nonempty since $\mathcal D$ has the FIP. If one of them is $B$, then the intersection is also nonempty since $B$ is an intersection of finitely many elements of $\mathcal D$ and $\mathcal D$ has the FIP. If $B \notin \mathcal D$, then $\mathcal E$ has the FIP and strictly contains $\mathcal D$, contradicting the maximality of $\mathcal D$. Therefore, $B \in \mathcal D$.

        Now, let $A \subseteq X$ be such that $A$ intersects every element of $\mathcal D$. Define $\mathcal F = \mathcal D \cup \set{A}$. Pick finitely elements of $\mathcal F$. If none of them is $A$, then their intersection is nonempty since $\mathcal D$ has the FIP. If one of them is $A$, then the intersection is also nonempty since $A$ intersects every element of $\mathcal D$ and $\mathcal D$ has the FIP. If $A \notin \mathcal D$, then $\mathcal F$ has the FIP and strictly contains $\mathcal D$, contradicting the maximality of $\mathcal D$. Therefore, $A \in \mathcal D$.
    \end{proof}
\end{lm}

\begin{thm}[Tychonoff]
    An arbitrary product of compact topological spaces is compact in the product topology.
    \begin{proof}
        Let $X = \prod_{\alpha \in I} X_\alpha$, where each $X_\alpha$ is compact. 

        Let $\mathcal A$ be a collection of subsets of $X$ that has the FIP. We will prove that
        \[
        \bigcap_{A\in \mathcal A} \Bar A \neq \emptyset.
        \]
        The result then follows from Theorem \ref{thm:compact-fip}. 

        By \ref{lm:tychonoff-lm1}, $\exists$ a collection $\mathcal D \supset \mathcal A$ maximal with respect to the FIP. It suffices to show that $\bigcap_{D\in \mathcal D} \Bar D \neq \emptyset$. Given $\alpha \in I$, let $\pi_\alpha: X \to X_\alpha$ be the projection map. Consider
        \[
        \set{\pi_\alpha(D) \mid D \in \mathcal D},
        \]
        which has the FIP since $\mathcal D$ has the FIP. Since $X_\alpha$ is compact, by Theorem \ref{thm:compact-fip}, we have
        \[
        \bigcap_{D\in \mathcal D} \Bar{\pi_\alpha(D)} \neq \emptyset.
        \]
        Pick an element $x_\alpha$ in the intersection. Define $x = (x_\alpha)_{\alpha \in I} \in X$. We will show that $x \in \Bar D$ for all $D \in \mathcal D$, hence $x \in \bigcap_{D\in \mathcal D} \Bar D$, implying that $\bigcap_{D\in \mathcal D} \Bar D$ is nonempty. 
        
        Let $\beta \in I$ and let $U_\beta$ be an open neighborhood of $x_\beta$ in $X_\beta$. Then $\pi_\beta^{-1}(U_\beta)$ is an open neighborhood of $x$ in $X$. We claim that $\pi_\beta^{-1}(U_\beta)$ intersects every element of $\mathcal D$. Given any $D \in \mathcal D$, by definition of $x$, 
        \begin{align*}
            x_\beta \in \Bar{\pi_\beta(D)} &\implies U_\beta \text{ intersects } \pi_\beta(D) \text{ in some point } \pi_\beta(y) \\
            &\implies y \in D \cap \pi_\beta^{-1}(U_\beta) \\
            &\implies D \cap \pi_\beta^{-1}(U_\beta) \neq \emptyset.
        \end{align*}
        By Lemma \ref{lm:tychonoff-lm2}, every set of the form $\pi_\beta^{-1}(U_\beta)$ that contains $x$ is in $\mathcal D$. 

        Recall that every basis element of the product topology is a finite intersection of sets of the form $\pi_\beta^{-1}(U_\beta)$. By Lemma \ref{lm:tychonoff-lm2}, every basis element that contains $x$ is in $\mathcal D$. Therefore, every open neighborhood of $x$ intersects every element of $\mathcal D$, hence $x \in \Bar D$ for all $D \in \mathcal D$. This completes the proof.
    \end{proof}
\end{thm}

\chapter{Cantor Sets}

The standard middle-third Cantor set is constructed as follows. Start with the closed interval $C_0 = [0, 1]$. Remove the open middle third $(1/3, 2/3)$ to obtain $C_1 = [0, 1/3] \cup [2/3, 1]$. Remove the open middle third of each remaining interval to obtain $C_2 = [0, 1/9] \cup [2/9, 1/3] \cup [2/3, 7/9] \cup [8/9, 1]$. Continuing this process indefinitely, we obtain a nested sequence of closed sets $C_0 \supseteq C_1 \supseteq C_2 \supseteq \cdots$. The Cantor set $C$ is defined to be the intersection of all $C_n$:
\[
C = \bigcap_{n=0}^\infty C_n.
\]
Note that $C$ is nonempty since it contains the endpoints of the intervals in each $C_n$.

\begin{df}
    A metric space $M$ is totally disconnected if for all $x \in M$ and $\forall \epsilon > 0$, $\exists$ a clopen set $U$ such that $x \in U \subseteq B(x, \epsilon)$.
\end{df}

\begin{ex}
    Any discrete metric space is totally disconnected. $\Q$ is totally disconnected. 
\end{ex}

\begin{rmk}
    The usual definition of totally disconnected is that the only connected subsets are singletons. The two definitions are equivalent for compact metric spaces.
\end{rmk}

\begin{thm}
    The Cantor set $C$ is a compact, nonempty, perfect, totally disconnected metric space.
    \begin{proof}
        The metric on $C$ is inherited from $\R$. Since $C$ is a closed subset of the compact set $[0, 1]$, $C$ is compact. We have already shown that $C$ is nonempty.

        Pick $x \in C$ and $\epsilon > 0$. Choose $n$ such that $1/3^n < \epsilon$. Then $x$ is contained in one of the $2^n$ closed intervals $I$ of length $1/3^n$ that make up $C_n$. Let
        \[
        E = \set{0, 1, \frac13, \frac23, \frac19, \frac29, \frac79, \frac89, \ldots}
        \]
        be the set of all endpoints of $C$. Since $E\cap I$ is an infinite set, and $(x - \epsilon, x + \epsilon)$ contains a point distinct from $x$ in $E\cap I$, $x$ is an accumulation point of $C$. Since $x$ is arbitrary, $C$ is perfect.

        Let $x \in C$ and $\epsilon > 0$. Choose $n$ such that $1/3^n < \epsilon$. Then $x$ is contained in one of the $2^n$ closed intervals $I$ of length $1/3^n$ that make up $C_n$. Note that both $I$ and its complement $J = C_n \setminus I$ are closed in $C_n$, hence they are clopen in $C_n$. Since $C \subseteq C_n$, $I \cap C$ and $J \cap C$ are clopen in $C$. Therefore, we have $x \in I \subseteq B(x, \epsilon)$, where $I$ is clopen in $C$. Since $x$ and $\epsilon$ are arbitrary, $C$ is totally disconnected.
    \end{proof}
\end{thm}

\begin{cl}
    Cantor set $C$ is uncountable.
    \begin{proof}
        Since compact spaces are complete, by \ref{thm:perfect-complete-uncountable}, $C$ is uncountable.
    \end{proof}
\end{cl}

\begin{rmk}
    In fact, one can show that every compact, nonempty, perfect, totally disconnected metric space is homeomorphic to the Cantor set. If $M$ is a compact metric space then $\exists$ a continuous surjection $f: C \to M$. This implies that every compact metric space has cardinality at most that of $\R$.
\end{rmk}

We can also show that the Cantor set is uncountable by constructing a bijection between $C$ and the set of all sequences of 0's and 2's. Consider the map $f: C \to \{0, 2\}^\N$ defined as follows. For each $x \in C$, we can write $x$ in base 3:
\[
x = \sum_{n=1}^\infty \frac{a_n}{3^n}, \quad a_n \in \{0, 1, 2\}.
\]
If $x \in C$, then $a_n \neq 1$ for all $n$. Clearly $f$ is injective. To see that $f$ is surjective, given any sequence $(b_n) \in \{0, 2\}^\N$, we can construct $x \in C$ by going through the construction of $C$. At the $n$-th step, if $b_n = 0$, we choose the left interval; if $b_n = 2$, we choose the right interval. The intersection of all these intervals is a singleton $\{x\}$ by \ref{prop:nested-closed-sets}, thus $f(x) = (b_n)$. Since $\{0, 2\}^\N$ is uncountable, $C$ is uncountable as well.

The Cantor set is large in terms of cardinality, but it is small in terms of topology and geometry.

\begin{df}
    Let $X$ be a topological space. A set $S \subseteq X$ is dense in $X$ if $\Bar S = X$. $S$ is somewhere dense in $X$ if there exists a nonempty open set $U \subseteq X$ such that $\Bar{S \cap U} = U$. $S$ is nowhere dense in $X$ if it is not somewhere dense.
\end{df}

A nowhere dense set is "small" in terms of topology.

\begin{prop}
    The Cantor set $C$ contains no interval and is nowhere dense in $\R$.
    \begin{proof}
        Suppose that $C$ contains an interval $(a, b)$. Then $\exists n$ such that $1/3^n < b - a$. But $C_n$ is the disjoint union of closed intervals of length $1/3^n$, so $(a, b)$ cannot be contained in $C_n$, contradicting the fact that $C \subseteq C_n$. Therefore, $C$ contains no interval.

        Suppose that $C$ is dense in some open set $U$, then
        \[
        C = \Bar{C} \supset \Bar{C \cap U} \supset U
        \]
        which contains an open interval, contradicting the fact that $C$ contains no interval. Therefore, $C$ is nowhere dense in $\R$.
    \end{proof}
\end{prop}

We will show that $C$ has measure $0$. A set with measure $0$ is "small" in terms of geometry.

\begin{df}
    A set $Z \subseteq \R$ has measure zero if for every $\epsilon > 0$, $\exists$ a countable cover of $Z$ by open intervals $\set{(a_k, b_k)}_{k \in \N}$ such that the total length of the cover
    \[
    \sum_{k=1}^\infty (b_k - a_k) \leq \epsilon.
    \]
\end{df}

\begin{prop}
    The following sets have measure zero:
    \begin{itemize}
        \item Any finite set.
        \item Any subset of a measure zero set.
        \item Any countable union of measure zero sets.
        \begin{proof}
            Let $Z_1, Z_2, \ldots$ be a sequence of measure zero sets and $Z = \bigcup_{n=1}^\infty Z_n$. Given $\epsilon > 0$, for each $n$, $\exists$ a countable cover of $Z_n$ by open intervals $\set{(a_k^{(n)}, b_k^{(n)})}_{k \in \N}$ such that
            \[
            \sum_{k=1}^\infty (b_k^{(n)} - a_k^{(n)}) \leq \frac{\epsilon}{2^n}.
            \]
            Then $\set{(a_k^{(n)}, b_k^{(n)}) \mid n, k \in \N}$ is a countable cover of $Z$ by open intervals such that
            \[
            \sum_{n=1}^\infty \sum_{k=1}^\infty (b_k^{(n)} - a_k^{(n)}) \leq \sum_{n=1}^\infty \frac{\epsilon}{2^n} = \epsilon.
            \]
            Therefore, $Z$ has measure zero.
        \end{proof}
        \item Any countable set.
        \item The middle-third Cantor set.
        \begin{proof}
            Let $\epsilon > 0$. Choose $n$ such that $2^n/3^n < \epsilon$. Then $C \subseteq C_n$, and $C_n$ is the disjoint union of $2^n$ closed intervals of length $1/3^n$. Cover each closed interval by an open interval of length $1/3^n + \delta$, where $\delta > 0$ is chosen such that
            \[
            2^n \delta < \epsilon - \frac{2^n}{3^n}.
            \]
            Then we have found a cover of $C$ by $2^n$ open intervals such that the total length of the cover is
            \[
            2^n \left(\frac{1}{3^n} + \delta\right) = \frac{2^n}{3^n} + 2^n \delta < \epsilon.
            \]
            Therefore, $C$ has measure zero.
        \end{proof}
    \end{itemize}
\end{prop}

\begin{rmk}
    It is nontrivial to prove that a nonempty open interval is not of measure zero. 
\end{rmk}

It is also possible to define a Cantor set that is not of measure zero, which is the \textit{Fat Cantor set}: in each step, we discard the middle $1/n!$ portion of each remaining interval at the $n$-th step. The resulting Cantor set is still compact, nonempty, perfect, and totally disconnected, but it has positive measure. This also implies that measure is not a topological property, since the Fat Cantor set is homeomorphic to the standard Cantor set, but they have different measures.

\chapter{Integration Theory}

\section{Riemann Integrals on $\R$}

Let $f: [a, b] \to \R$ be a function. Intuitively, the integral of $f$ is the area under the curve $y = f(x)$. 

A partition pair consists of two finite sets of points in $P, T \subseteq [a, b]$ where $P = \{x_0, x_1, \ldots, x_n\}$ and $T = \{t_1, t_2, \ldots, t_n\}$ are interlaced as
\[
a = x_0 \leq t_1 \leq x_1 \leq t_2 \leq x_2 \leq \cdots \leq t_n \leq x_n = b.
\]
Assume that the points $x_0, x_1, \ldots, x_n$ are distinct. The Riemann sum of $f$ with respect to the partition pair $(P, T)$ is defined to be
\[
R(f, P, T) = \sum_{i=1}^n f(t_i)(x_i - x_{i-1}).
\]
The mesh of the partition $P$ is defined to be
\[
~mesh (P) = \max_{1 \leq i \leq n} (x_i - x_{i-1}).
\]
A real number $I$ is the Riemann integral of $f$ over $[a, b]$ if for every $\epsilon > 0$, $\exists \delta > 0$ such that for every partition pair $(P, T)$ with $~mesh(P) < \delta$, we have
\[
|R(f, P, T) - I| < \epsilon.
\]

If such an $I$ exists, it must be unique, and we write
\[
\int_a^b f(x) \, dx = I = \lim_{~mesh(P) \to 0} R(f, P, T).
\]
In this case, we say that $f$ is Riemann integrable on $[a, b]$ with Riemann integral $I$.

\begin{itemize}
    \item If $f$ is Riemann integrable on $[a, b]$, then $f$ is bounded on $[a, b]$.
    \item $f \mapsto \int_a^b f(x) \, dx$ is linear.
    \item If $f, g$ are Riemann integrable on $[a, b]$ and if $f(x) \leq g(x)$ for all $x \in [a, b]$, then
    \[
    \int_a^b f(x) \, dx \leq \int_a^b g(x) \, dx.
    \]
    \item If $f$ is Riemann integrable on $[a, b]$ and if $|f(x)| \leq M$ for all $x \in [a, b]$, then
    \[
    \abs{\int_a^b f(x) \, dx} \leq M(b - a).
    \]
\end{itemize}

Let $f: [a, b] \to [-M, M]$ be a bounded function. For a partition $P = \{x_0, x_1, \ldots, x_n\}$ of $[a, b]$, define
\[
L(f, P) = \sum_{i=1}^n m_i (x_i - x_{i-1}), \quad U(f, P) = \sum_{i=1}^n M_i (x_i - x_{i-1}),
\]
where
\[
m_i = \inf \{f(x) \mid x \in [x_{i-1}, x_i]\}, \quad M_i = \sup \{f(x) \mid x \in [x_{i-1}, x_i]\}.
\]
For any partition pair $(P, T)$, we have
\[
L(f, P) \leq R(f, P, T) \leq U(f, P).
\]
Define the lower integral and upper integral of $f$ over $[a, b]$ to be
\[
\underline{I} = \sup_P L(f, P), \quad \overline{I} = \inf_P U(f, P).
\]
If $\underline{I} = \overline{I}$, then we say that $f$ is Darboux integrable on $[a, b]$ with Darboux integral $I = \underline{I} = \overline{I}$.

We wish to show that Riemann integrability is equivalent to Darboux integrability, and in this case, the two integrals are equal.

\begin{df}
    A partition $P'$ refines another partition $P$ if $P \subseteq P'$.
\end{df}

\begin{lm}
    If $P'$ refines $P$, then $L(f, P) \leq L(f, P')$ and $U(f, P') \leq U(f, P)$.
    \begin{proof}
        By induction, it suffices to consider $P' = P \cup \set{w}$, where $w \in (x_{i-1}, x_i)$ for some $i$. Lower sums for $P$ and $P'$ are the same except that the term $m_i (x_i - x_{i-1})$ in $L(f, P)$ is replaced by
        \[
        m_i (w - x_{i-1}) + m_{i+1} (x_i - w) \geq m_i (x_i - x_{i-1})
        \]
        in $L(f, P')$. Therefore, $L(f, P) \leq L(f, P')$. The proof for upper sums is similar.
    \end{proof}
\end{lm}

If $P, P'$ are partitions of $[a, b]$, then for the common refinement $P^* = P \cup P'$, we have
\[
L(f, P) \leq L(f, P^*) \leq U(f, P^*) \leq U(f, P'),
\]
hence each lower sum is a lower bound for each upper sum. Therefore, a bounded function $f$ is Darboux integrable on $[a, b]$ iff for every $\epsilon > 0$, $\exists$ a partition $P$ of $[a, b]$ such that
\[
U(f, P) - L(f, P) < \epsilon.
\]

\begin{thm}
    Riemann integrability is equivalent to Darboux integrability, and when $f$ is integrable in either sense, its lower integral, upper integral, and Riemann integral are equal.
    \begin{proof}
        Let $f: [a, b] \to \R$ be Riemann integrable with Riemann integral $I$. $\forall \epsilon > 0$, $\exists \delta > 0$ such that for every partition pair $(P, T)$ with $~mesh(P) < \delta$, we have
        \[
        |R(f, P, T) - I| < \epsilon/4.
        \]
        Fix such a partition $P = \{x_0, x_1, \ldots, x_n\}$, and choose $T = \{t_1, t_2, \ldots, t_n\}$ such that
        \[
        t_i \in [x_{i-1}, x_i] \quad \text{and} \quad f(t_i) - m_i < \frac{\epsilon}{4(b - a)} \quad \text{for all } 1 \leq i \leq n.
        \]
        Then
        \begin{align*}
            R(f, P, T) - L(f, P) &= \sum_{i=1}^n (f(t_i) - m_i)(x_i - x_{i-1}) \\
            &< \sum_{i=1}^n \frac{\epsilon}{4(b - a)} (x_i - x_{i-1}) = \frac{\epsilon}{4(b - a)} (b - a) = \frac{\epsilon}{4}.
        \end{align*}
        Similarly, choose $T' = \{t_1', t_2', \ldots, t_n'\}$ such that
        \[
        U(f, P) - R(f, P, T') < \frac{\epsilon}{4}.
        \]
        Therefore,
        \[
        U(f, P) - L(f, P) < \frac{\epsilon}{2} + |R(f, P, T') - I| + |R(f, P, T) - I| < \epsilon,
        \]
        thus $f$ is Darboux integrable.

        Conversely, let $f: [a, b] \to [-M, M]$ be Darboux integrable. $\forall \epsilon > 0$, $\exists$ a partition $P_1$ of $[a, b]$ such that
        \[
        U(f, P_1) - L(f, P_1) < \epsilon/3.
        \]
        Fix $\epsilon > 0$ and choose
        \[
        \delta = \frac{\epsilon}{12 n_1 M},
        \]
        where $n_1$ is the number of points in $P_1$. Choose any partition $P, T$ with $~mesh (P) < \delta$. We want to show that
        \[
        \abs{R(f, P, T) - I} < \epsilon.
        \]

        Define $P^* = P \cup P_1$, which refines both $P$ and $P_1$, then
        \[
        U(f, P^*) - L(f, P^*) \leq U(f, P_1) - L(f, P_1) < \epsilon/3.
        \]
        Now, we compare the upper integrals $U(f, P^*)$ and $U(f, P)$. Except for at most $2n_1$ many exceptional $P^*$-intervals that have endpoints in $P_1$, we have $I_j^* = I_j$ and $M_j^* = M_j$ for all other $P^*$-intervals. Set
        \begin{gather*}
            \mathcal I = \set{i \mid I_i \text{ contains exceptional subintervals}}, \\
            \mathcal J(i) = \set{j \mid I_j^* \text{ is an exceptional subinterval of } I_i},
        \end{gather*}
        then
        \begin{align*}
            U(f, P) - U(f, P^*) &= \sum_{i \in \mathcal I} M_i(x_i - x_{i-1}) - \sum_{i \in \mathcal I} \sum_{j \in \mathcal J(i)} M_j^*(x_j^* - x_{j-1}^*) \\
            &= \sum_{i \in \mathcal I} \sum_{j \in \mathcal J(i)} (M_i - M_j^*)(x_j^* - x_{j-1}^*)
        \end{align*}
        Note that $M_i - M_j^* \leq 2M$ and
        \[
        \sum_{i \in \mathcal I} \sum_{j \in \mathcal J(i)} (x_j^* - x_{j-1}^*) \leq 2n_1 ~mesh(P) < 2n_1 \delta = \frac{\epsilon}{6M},
        \]
        hence
        \[
        U(f, P) - U(f, P^*) < 2M \cdot \frac{\epsilon}{6M} = \frac{\epsilon}{3}.
        \]
        Similarly, we can show that
        \[
        L(f, P^*) - L(f, P) < \frac{\epsilon}{3}.
        \]
        Therefore,
        \begin{align*}
            U(f, P) - L(f, P) &< \frac{\epsilon}{3} + (U(f, P^*) - L(f, P^*)) + \frac{\epsilon}{3} \\
            &< \epsilon/3 + \epsilon/3 + \epsilon/3 = \epsilon.
        \end{align*}
        Note that both $R(f, P, T)$ and $I$ lie between $L(f, P)$ and $U(f, P)$, hence
        \[
        |R(f, P, T) - I| < \epsilon.
        \]
        This completes the proof.
    \end{proof}
\end{thm}

\begin{ex}
    Any continuous function on $[a, b]$ is Riemann integrable.
    \begin{proof}
        Let $\epsilon > 0$ be given. Then $\exists \delta > 0$ such that for all $x, y \in [a, b]$, if $|x - y| < \delta$, then $|f(x) - f(y)| < \epsilon/(b - a)$. For any partition $P$ with $~mesh(P) < \delta$, we have
        \[
        M_i - m_i < \frac{\epsilon}{b - a} \quad \text{for all } 1 \leq i \leq n,
        \]
        hence
        \[
        U(f, P) - L(f, P) = \sum_{i=1}^n (M_i - m_i)(x_i - x_{i-1}) < \sum_{i=1}^n \frac{\epsilon}{b - a} (x_i - x_{i-1}) = \epsilon.
        \]
        Thus $f$ is Riemann integrable.
    \end{proof}
\end{ex}

\begin{prop}
    A function $f: [a, b] \to \R$ is Riemann integrable if for all $\epsilon > 0$, $\exists$ functions $g, h: [a, b] \to \R$ such that $g(x) \leq f(x) \leq h(x)$ for all $x \in [a, b]$, $g$ and $h$ are Riemann integrable, and
    \[
    \int_a^b (h(x) - g(x)) \, dx < \epsilon.
    \]
    \begin{proof}
        Let $\epsilon > 0$. Choose Riemann integrable $g, h$ such that $g(x) \leq f(x) \leq h(x)$ for all $x \in [a, b]$ and
        \[
        \int_a^b (h(x) - g(x)) \, dx < \epsilon/3.
        \]
        For all partition $P$, we have
        \[
        L(g, P) \leq L(f, P) \leq U(f, P) \leq U(h, P).
        \]
        Since $g$ and $h$ are Riemann integrable, $\exists$ a partition $P$ such that
        \[
        \int_a^b g(x) \, dx - L(g, P) < \epsilon/3, \quad U(h, P) - \int_a^b h(x) \, dx < \epsilon/3.
        \]
        Combining these inequalities, we have
        \begin{align*}
            U(f, P) - L(f, P) &< U(h, P) - L(g, P) \\
            &< \int_a^b h(x) \, dx - \int_a^b g(x) \, dx + 2\epsilon/3 \\
            &= \int_a^b (h(x) - g(x)) \,dx + 2\epsilon/3 < \epsilon.
        \end{align*}
        Therefore, $f$ is Riemann integrable.
    \end{proof}
\end{prop}

\begin{df}
    Given a set $E \subset \R$, the characteristic function of $E$ is defined to be
    \[
    \chi_E(x) = \begin{cases}
        1, & x \in E \\
        0, & x \notin E
    \end{cases}
    \]
\end{df}

\begin{ex}[Thomae's Function]
    Define $[0, 1] \to \Q$ by
    \[
    f(x) = \begin{cases}
        \frac1q, & x = \frac{p}{q} \text{ in lowest terms} \\
        0, & x \text{ is irrational}
    \end{cases}
    \]
    $f$ is discontinuous at every rational point but continuous at every irrational point. For $\epsilon > 0$, define
    \[
    S_\epsilon(x) = \begin{cases}
        \frac1q, & x = \frac{p}{q} \text{ in lowest terms and } q < \frac1\epsilon \\
        0, & \text{otherwise}
    \end{cases}
    \]
    $S_\epsilon$ is Riemann integrable with integral $0$ since $S_\epsilon$ is nonzero at only finitely many points. Take $g(x) = 0$ and $h(x) = \epsilon + S_\epsilon(x)$, then $g(x) \leq f(x) \leq h(x)$ for all $x \in [0, 1]$, thus $f$ is Riemann integrable with integral $0$ by the previous proposition.
\end{ex}

If a property holds for all points except for a set of measure zero, then we say that the property holds almost everywhere.

\begin{thm}[Riemann's Integrability Criterion]
    $f: [a, b] \to \R$ is Riemann integrable iff $f$ is bounded and continuous almost everywhere.
    \begin{proof}
        Define the oscillation of $f$ at $x \in [a, b]$ to be
        \[
        ~osc _x(f) = \limsup_{t \to x} f(t) - \liminf_{t \to x} f(t).
        \]
        Note that $f$ is continuous at $x$ iff $~osc_x(f) = 0$. If $I$ is any interval containing $x$, then
        \[
        \sup_{t \in I} f(t) - \inf_{t \in I} f(t) \geq ~osc _x(f).
        \]

        "$\implies$": Suppose that $f$ is Riemann integrable, then $f$ is bounded, say $\abs{f(x)} \leq M$ for all $x \in [a, b]$. Let $\mathcal D$ denote the set of discontinuities of $f$. Write
        \[
        \mathcal D = \bigcup_{k=1}^\infty \mathcal D_k, \quad \mathcal D_k = \set{x \in [a, b] \mid ~osc _x(f) \geq \frac1k}.
        \]
        It suffices to show that each $\mathcal D_k$ has measure zero. Given $\epsilon > 0$ and $k \in \N$, there exists a partition $P = \{x_0, x_1, \ldots, x_n\}$ of $[a, b]$ such that
        \[
        U(f, P) - L(f, P) = \sum_{i=1}^n (M_i - m_i)(x_i - x_{i-1}) < \frac{\epsilon}{k}.
        \]
        We say that a $\mathcal P$-interval $I_i = (x_{i-1}, x_i)$ is bad if it contains a point $x \in \mathcal D_k$ in its interior. On a bad interval $I_i$, we have $M_i - m_i \geq ~osc_x(f) \geq 1/k$. Therefore,
        \[
        \sum_{I_i \text{ is bad}} (x_i - x_{i-1}) \leq k \sum_{i=1}^n (M_i - m_i)(x_i - x_{i-1}) < k \cdot \frac{\epsilon}{k} = \epsilon.
        \]
        The collection of all bad $\mathcal P$-intervals covers $\mathcal D_k$ except possibly the endpoints of these intervals, which is a finite set. Therefore, $\mathcal D_k$ has measure zero.

        "$\impliedby$": Suppose that $f$ is bounded and continuous almost everywhere, say $\abs{f(x)} \leq M$ for all $x \in [a, b]$. Let $\mathcal D$ denote the set of discontinuities of $f$, and define $\mathcal D_k$ as above. Given $\epsilon > 0$, pick $k \in \N$ such that
        \[
        \frac1k < \frac{\epsilon}{2(b - a)}
        \]
        Since $\mathcal D_k$ has measure zero, $\exists$ a countable cover $\mathcal J$ of $\mathcal D_k$ by open intervals $J_j = (a_j, b_j)$ such that
        \[
        \sum_{j=1}^\infty (b_j - a_j) < \frac{\epsilon}{4M}.
        \]
        On the other hand, for each $x \in [a, b] \setminus \mathcal D_k$, $\exists$ an open interval $I_x$ containing $x$ such that
        \[
        \sup_{t \in I_x} f(t) - \inf_{t \in I_x} f(t) < 1/k.
        \]
        These intervals $I_x$ form an open cover $\mathcal I$ of $[a, b] \setminus \mathcal D_k$, hence $\mathcal U := \mathcal I \cup \mathcal J$ is an open cover of $[a, b]$. By compactness, $\mathcal U$ has a positive Lebesgue number $\lambda > 0$. 
        
        Let $\mathcal P = \set{x_0, x_1, \ldots, x_n}$ be any partition of $[a, b]$ with $~mesh(\mathcal P) < \lambda$. We claim that $U(f, P) - L(f, P) < \epsilon$. By definition of Lebesgue number, each $\mathcal P$-interval is contained entirely in some $I_x$ or in some $J_j$. Define
        \[
        \mathbb I = \set{i \mid I_i \subseteq J_j \text{ for some } j}.
        \]
        Since $\mathbb I$ contains at most finitely many indices, there exists a finite $m$ such that
        \[
        \bigcup_{i \in \mathbb I} I_i \subseteq J_1 \cup J_2 \cup \cdots \cup J_m.
        \]
        Therefore,
        \begin{align*}
            U(f, P) - L(f, P) &= \sum_{i \in \mathbb I} (M_i - m_i)(x_i - x_{i-1}) + \sum_{i \notin \mathbb I} (M_i - m_i)(x_i - x_{i-1}) \\
            &\leq 2M \sum_{i \in \mathbb I} (x_i - x_{i-1}) + \frac1k \sum_{i \notin \mathbb I} (x_i - x_{i-1}) \\
            &\leq 2M \sum_{j=1}^m (b_j - a_j) + \frac1k (b - a) < 2M \cdot \frac{\epsilon}{4M} + \frac{\epsilon}{2} = \epsilon.
        \end{align*}
        This completes the proof.
    \end{proof}
\end{thm}

\begin{rmk}
    Being equal to a continuous function almost everywhere does not imply it is continuous almost everywhere, in particular does not imply Riemann integrability. For example, the characteristic function of $\Q$ is equal to the zero function almost everywhere, but it is not Riemann integrable.
\end{rmk}

\begin{cl}
    Every bounded piecewise continuous function is Riemann integrable.
    \begin{proof}
        The set of discontinuities of a piecewise continuous function is finite, hence has measure zero. 
    \end{proof}
\end{cl}

\begin{cl}
    The characteristic function of a set $S \subseteq [a, b]$ is Riemann integrable iff the boundary $\partial S$ has measure zero.
    \begin{proof}
        Note that $\chi_S$ is continuous at $x$ iff $x \notin \partial S$. Therefore, the set of discontinuities of $\chi_S$ is exactly $\partial S$. 
    \end{proof}
\end{cl}

\begin{cl}
    Every monotone function on $[a, b]$ is Riemann integrable.
    \begin{proof}
        A monotone function can have only jump discontinuities, hence the set of discontinuities is at most countable, thus has measure zero. 
    \end{proof}
\end{cl}

\begin{cl}
    The product of Riemann integrable functions is Riemann integrable.
    \begin{proof}
        The set of discontinuities of the product is contained in the union of the sets of discontinuities of the factors, hence has measure zero. 
    \end{proof}
\end{cl}

\begin{cl}
    If $f: [a, b] \to [c, d]$ is Riemann integrable and $\phi: [c, d] \to \R$ is continuous, then $\phi \circ f$ is Riemann integrable.
    \begin{proof}
        The set of discontinuities of $\phi \circ f$ is contained in the set of discontinuities of $f$, hence has measure zero. Since $[c, d]$ is compact, $\phi$ is bounded, thus $\phi \circ f$ is bounded as well.
    \end{proof}
\end{cl}

\begin{cl}
    If $f$ is Riemann integrable then so is $|f|$.
    \begin{proof}
        Take $\phi(x) = |x|$ in the previous corollary.
    \end{proof}
\end{cl}

\begin{cl}
    If $a < c < b$ and $f: [a, b] \to \R$ is Riemann integrable, then $f$ is Riemann integrable on $[a, c]$ and $[c, b]$, and
    \[
    \int_a^b f(x) \, dx = \int_a^c f(x) \, dx + \int_c^b f(x) \, dx.
    \]
    Conversely, if $f$ is Riemann integrable on $[a, c]$ and $[c, b]$, then $f$ is Riemann integrable on $[a, b]$ and the same equality holds.
    \begin{proof}
        The set of discontinuities of $f$ on $[a, b]$ is the union of the sets of discontinuities of $f$ on $[a, c]$ and $[c, b]$ (and possibly the point $c$), hence $f$ is Riemann integrable iff $f|_{[a, c]}$ and $f|_{[c, b]}$ are Riemann integrable. Note that
        \[
        f = f \chi_{[a, c]} + f \chi_{[c, b]}.
        \]
        Then the formula follows from linearity of the integral.
    \end{proof}
\end{cl}

\begin{cl}
    A Riemann integrable function $f: [a, b] \to [0, M]$ has integral $0$ iff $f(x) = 0$ almost everywhere.
    \begin{proof}
        "$\implies$": Suppose that $f$ is Riemann integrable with integral $0$. If $f$ is nonzero at some continuity point $x_0$, then $\exists$ an open interval $(x_0 - \delta, x_0 + \delta) \subseteq [a, b]$ such that $f(x) > M/2$ for all $x$ in this interval. Therefore,
        \[
        \int_a^b f(x) \, dx \geq \int_{x_0 - \delta}^{x_0 + \delta} f(x) \, dx \geq \int_{x_0 - \delta}^{x_0 + \delta} \frac{f(x_0)}{2} \, dx = f(x_0)\delta > 0,
        \]
        contradicting the assumption that the integral is $0$. Therefore, $f(x) = 0$ at every continuity point of $f$, hence $f(x) = 0$ almost everywhere.

        "$\impliedby$": Suppose that $f(x) = 0$ almost everywhere, then every interval contains a point $x$ such that $f(x) = 0$. Therefore, for every partition $P$, we have $m_i = 0$ for all $1 \leq i \leq n$, hence
        \[
        0 \leq \int_a^b f(x) \, dx = \underline{I} = \sup_P L(f, P) = 0.
        \]
        Thus the integral is $0$.
    \end{proof}
\end{cl}

\begin{cl}
    If $f: [a, b] \to \R$ is Riemann integrable and if $\psi: [c, d] \to [a, b]$ is a homeomorphism such that $\psi^{-1}$ is Lipschitz, then $f \circ \psi$ is Riemann integrable.
    \begin{proof}
        Clearly $f \circ \psi$ is bounded. Let $\mathcal D$ denote the set of discontinuities of $f$, then the set of discontinuities of $f \circ \psi$ is $\psi^{-1}(\mathcal D)$. Since $\mathcal D$ has measure zero, for every $\epsilon > 0$, $\exists$ a countable cover of $\mathcal D$ by open intervals $\set{(a_k, b_k)}_{k \in \N}$ such that
        \[
        \sum_{k=1}^\infty (b_k - a_k) < \epsilon.
        \]
        Since $\psi^{-1}$ is Lipschitz, $\exists C > 0$ such that for all $x, y \in [a, b]$,
        \[
        |\psi^{-1}(x) - \psi^{-1}(y)| \leq C |x - y|.
        \]
        Therefore, $\set{(\psi^{-1}(a_k), \psi^{-1}(b_k))}_{k \in \N}$ is a countable cover of $\psi^{-1}(\mathcal D)$ by open intervals of total length at most $C \epsilon$. Since $\epsilon$ is arbitrary, $\psi^{-1}(\mathcal D)$ has measure zero. Hence $f \circ \psi$ is Riemann integrable.
    \end{proof}
\end{cl}

\begin{rmk}
    If $f$ is Riemann integrable and $\psi$ is continuous but not Lipschitz, then $f \circ \psi$ may not be Riemann integrable. In particular, composition of two Riemann integrable functions may not be Riemann integrable. 
\end{rmk}

\section{Fundamental Theorem of Calculus}

Let $f: [a, b] \to \R$ be Riemann integrable. Define the indefinite integral (or integral function) of $f$ to be
\[
F(x) = \int_a^x f(t) \, dt \quad \text{for all } x \in [a, b].
\]
$F$ is continuous on $[a, b]$ since for all $x, y \in [a, b]$. Moreover, the derivative of $F$ exists and $F'(x) = f(x)$ at every point where $f$ is continuous.

An antiderivative of $f$ is a function $F: [a, b] \to \R$ such that $F'(x) = f(x)$ for all $x \in [a, b]$.

\begin{cl}
    Every continuous function on $[a, b]$ has an antiderivative.
\end{cl}

The second part of the Fundamental Theorem of Calculus states that an antiderivative of a Riemann integrable function, if it exists, differs from the indefinite integral by a constant.

\begin{thm}
    There exists a continuous $H: [0, 1] \to \R$ whose derivative exists and equals $0$ almost everywhere, but such that $H$ is not constant.
    \begin{proof}
        Each $x \in [0, 1]$ has a unique ternary expansion
        \[
        x = \sum_{n=1}^\infty \frac{a_n}{3^n}, \quad a_n \in \set{0, 1, 2}.
        \]
        Define
        \[
        H(x) = \sum_{n=1}^\infty \frac{b_n / 2}{2^n}, 
        \]
        for $x \in C$, where $C$ is the Cantor set. Note that $H$ has equal values at the endpoints of each removed interval, hence $H$ can be extended to be constant on each removed interval. 

        Let $\epsilon > 0$, and choose $n$ such that $1/2^n < \epsilon$. Take $x, x' \in C$ such that $|x - x'| < 3^{-n}$. Since each discarded open interval has length $3^{-n}$ in $C_n$, $x$ and $x'$ must lie in the same closed interval of $C_n$, hence the ternary expansions of $x$ and $x'$ agree up to the $n$-th digit. Therefore,
        \[
        |H(x) - H(x')| \leq \sum_{k=n+1}^\infty \frac{1/2}{2^k} = \frac{1}{2^n} < \epsilon.
        \]
        This shows that $H$ is uniformly continuous on $C$. Since $H$ is constant on $[0, 1] \setminus C$, $H$ is uniformly continuous on $[0, 1]$, thus $H([0, 1]) = [0, 1]$, also $H$ is differentiable with derivative $0$ at every point in $[0, 1] \setminus C$. Therefore, $H$ is not constant but $H' = 0$ almost everywhere.
    \end{proof}
\end{thm}

\begin{rmk}
    It is even possible to construct a strictly increasing continuous function whose derivative is $0$ almost everywhere. 
\end{rmk}

\section{Multiple Integrals}

For notational simplicity, we will only consider functions of two variables, but the definitions and results can be easily generalized to functions of more than two variables.

Consider a rectangle $R = [a, b] \times [c, d] \subseteq \R^2$. Consider a pair of partitions $P = \{x_0, x_1, \ldots, x_m\}$ of $[a, b]$ and $Q = \{y_0, y_1, \ldots, y_n\}$ of $[c, d]$. Let $G$ be the grid partition $G$ consisting of the rectangles
\[
R_{ij} = [x_{i-1}, x_i] \times [y_{j-1}, y_j], \quad 1 \leq i \leq m, \; 1 \leq j \leq n.
\]
Let $S$ be a set of sample points $s_{ij} \in R_{ij}$ for all $1 \leq i \leq m$ and $1 \leq j \leq n$. The Riemann sum of a bounded function $f: R \to \R$ with respect to the grid partition $G$ and the sample points $S$ is defined to be
\[
R(f, G, S) = \sum_{i=1}^m \sum_{j=1}^n f(s_{ij}) \Delta x_i \Delta y_j,
\]
where $\Delta x_i = x_i - x_{i-1}$ and $\Delta y_j = y_j - y_{j-1}$. The mesh of the grid partition $G$ is defined to be
\[
~mesh(G) = \max_{1 \leq i \leq m, 1 \leq j \leq n} ~diam(R_{ij}).
\]
The function $f$ is Riemann integrable on $R$ if the limit of the Riemann sums exists as the mesh of the partition goes to zero:
\[
\int_R f(x, y) \, dA = \lim_{~mesh(G) \to 0} R(f, G, S).
\]

The lower sum and upper sum of $f$ with respect to the grid partition $G$ are defined to be
\[
L(f, G) = \sum_{i=1}^m \sum_{j=1}^n m_{ij} \Delta x_i \Delta y_j, \quad U(f, G) = \sum_{i=1}^m \sum_{j=1}^n M_{ij} \Delta x_i \Delta y_j,
\]
where
\[
m_{ij} = \inf_{(x, y) \in R_{ij}} f(x, y), \quad M_{ij} = \sup_{(x, y) \in R_{ij}} f(x, y).
\]
The lower integral and upper integral of $f$ on $R$ are defined to be
\[
\underline{\int}_R f = \sup_G L(f, G), \quad \overline{\int}_R f = \inf_G U(f, G),
\]
where the supremum and infimum are taken over all grid partitions $G$ of $R$. The function $f$ is Darboux integrable on $R$ if $\underline{\int}_R f = \overline{\int}_R f$.

\begin{prop}
    \begin{itemize}
        \item If $f$ is Riemann integrable on $R$, then $f$ is bounded.
        \item The set of Riemann integrable functions on $R$ is a vector space, and the integral is a linear functional on this space.
        \item Constant functions $f \equiv c$ are integrable and its integral is $c \cdot |R|$.
        \item If $f, g$ are Riemann integrable on $R$ and if $f(x, y) \leq g(x, y)$ for all $(x, y) \in R$, then
        \[
        \int_R f(x, y) \, dA \leq \int_R g(x, y) \, dA.
        \]
        \item If $f$ is Riemann integrable on $R$, then
        \[
        \underline{\int}_R f = \overline{\int}_R f = \int_R f.
        \]
    \end{itemize}
\end{prop}

\begin{df}
    A set $Z \subseteq \R^2$ is of measure zero if for every $\epsilon > 0$, $\exists$ a countable cover of $Z$ by open rectangles $S_l$ whose total area is less than $\epsilon$:
    \[
    \sum_{l=1}^\infty |S_l| < \epsilon.
    \]
\end{df}

Using the same argument as in the one-dimensional case, we can show that a countable union of measure zero sets has measure zero. For $z \in R$, define the oscillation of $f$ at $z$ to be
\[
~osc_z(f) = \lim_{r \to 0^+} ~diam(f(B(z, r) \cap R)).
\]
Denote the set of discontinuities of $f$ by
\[
\mathcal D = \bigcup_{k=1}^\infty \mathcal D_k, \quad \mathcal D_k = \set{z \in R \mid ~osc_z(f) \geq \frac1k}.
\]
Since $\mathcal D_k$ is closed, it is compact.

\begin{thm}[Riemann Integrability Criterion in Higher Dimensions]
    A bounded function $f: R \to \R$ is Riemann integrable iff the set of discontinuities of $f$ has measure zero.
\end{thm}

Suppose that $f: R \to \R$ is Riemann integrable. For each fixed $y \in [c, d]$, define the lower slice integral and upper slice integral of $f$ at $y$ to be
\[
\underline{F}(y) = \underline{\int}_a^b f(x, y) \, dx, \quad \overline{F}(y) = \overline{\int}_a^b f(x, y) \, dx.
\]
Note that these are just the lower and upper integrals of the one-variable function $f_y(x) = f(x, y)$ on $[a, b]$.

\begin{thm}[Fubini's Theorem]
    If $f: R \to \R$ is Riemann integrable, then so are $\underline{F}$ and $\overline{F}$. Moreover,
    \[
    \int_R f(x, y) \, dA = \int_c^d \underline{F}(y) \, dy = \int_c^d \overline{F}(y) \, dy.
    \]
    \begin{proof}
        Let $G = P \times Q$ be a grid partition of $R$, where $P = \{x_0, x_1, \ldots, x_m\}$ is a partition of $[a, b]$ and $Q = \{y_0, y_1, \ldots, y_n\}$ is a partition of $[c, d]$. 

        We first show that $L(f, G) \leq L(\underline{F}, Q)$. Fix a partition $J_j \subseteq [c, d]$ of $Q$. If $y \in J_j$, 
        \[
        m_{ij} = \inf \set{f(s, t) \mid (s, t) \in R_{ij}} \leq \inf \set{f(s, y) \mid s \in I_i} = m_i(f_y),
        \]
        hence for all $y \in J_j$,
        \[
        \sum_{i=1}^m m_{ij} \Delta x_i \leq \sum_{i=1}^m m_i(f_y) \Delta x_i = L(f_y, P) \leq \underline{\int}_a^b f_y(x) \, dx = \underline{F}(y).
        \]
        Therefore,
        \[
        \sum_{i=1}^m m_{ij} \Delta x_i \leq \inf_{y \in J_j} \underline{F}(y) = m_j(\underline{F}),
        \]
        and
        \[
        L(f, G) = \sum_{j=1}^n \sum_{i=1}^m m_{ij} \Delta x_i \Delta y_j \leq \sum_{j=1}^n m_j(\underline{F}) \Delta y_j = L(\underline{F}, Q).
        \]
        Similarly, we can show that $U(f, G) \geq U(\overline{F}, Q)$, thus
        \[
        L(f, G) \leq L(\underline{F}, Q) \leq U(\overline{F}, Q) \leq U(f, G).
        \]
        Since $f$ is Riemann integrable, we know that
        \[
        \sup_Q L(\underline{F}, Q) = \inf_Q U(\overline{F}, Q) = \int_R f(x, y) \, dA,
        \]
        hence $\underline{F}$ and $\overline{F}$ are Riemann integrable with
        \[
        \int_c^d \underline{F}(y) \, dy = \int_c^d \overline{F}(y) \, dy = \int_R f(x, y) \, dA.
        \]
    \end{proof}
\end{thm}

\begin{cl}
    If $f: R \to \R$ is Riemann integrable, then the order of integration does not affect the value of the integral.
\end{cl}

\begin{cl}[Cavalier's Principle]
    The area of a region $S \subseteq R$ is the integral with respect to $x$ of the lengths of the vertical slices:
    \[
    ~area (S) = \int_a^b ~length (S_x) \, dx,
    \]
    provided that $\partial S$ has measure zero, where $S_x = \set{y \in [c, d] \mid (x, y) \in S}$.
    \begin{proof}
        Take $f = \chi_S$ in Fubini's Theorem.
    \end{proof}
\end{cl}

\begin{df}
    If $S \subseteq \R^2$ is bounded, we define its area (or Jordan content) to be $\int \chi_S \, dA$ if exists. If the integral exists, we say that $S$ is Riemann measurable. Denote the area by
    \[
    |S| = ~area (S) = \int \chi_S \, dA.
    \]
\end{df}

\section{Change of Variables}

\begin{prop}
    If $T: \R^2 \to \R^2$ is a linear transformation, then for every Riemann measurable set $S \subseteq \R^2$, $T(S)$ is Riemann measurable and
    \[
    |T(S)| = |~det(T)| \cdot |S|.
    \]
    \begin{proof}
        If $A$ is a matrix representation of $T$, then we can decompose $A$ into a product of elementary matrices. It suffices to prove the proposition for each type of elementary matrices.

        Consider first that $S = [a, b] \times [c, d]$ is a rectangle. If $T$ is a scaling matrix, then the result is clear. If $T$ is a permutation matrix, then $|T(S)| = |S|$. If $T$ is a shear matrix, then it converts $S$ into a parallelogram
        \[
        \mathcal P = \set{(x, y) \mid a + \sigma y \leq x + b + \sigma y,\, c \leq y \leq d}.
        \]
        We can show that $\mathcal P$ is Riemann measurable, whose area can be computed using Cavalier's Principle:
        \[
        |\mathcal P| = \int_c^d \int_{a + \sigma y}^{b + \sigma y} 1 \, dx \, dy = \int_c^d (b - a) \, dy = (b - a)(d - c) = |S|.
        \]
        
        Now let $S$ be a general Riemann measurable set. Given $\epsilon > 0$, let $H \subseteq S$ be a rectangle. Take a grid $G$ on $H$ such that
        \[
        |S| - \epsilon \leq \sum_{R \subseteq S} |R| \leq \sum_{R: R\cap S \neq \emptyset} |R| \leq |S| + \epsilon.
        \]
        This is always possible since $\chi_S$ is Riemann integrable and
        \[
        \sum_{R \subseteq S} |R| = L(\chi_S, G), \quad \sum_{R: R\cap S \neq \emptyset} |R| = U(\chi_S, G).
        \]
        Since the interior of the inner rectangles are disjoint, we have
        \[
        \sum_{R \subseteq S} \chi_{~int (R)}(z) \leq \chi_S(z) \leadsto \sum_{R \subseteq S} \chi_{~int (T(R))}(w) \leq \chi_{T(S)}(w).
        \]
        Therefore,
        \begin{align*}
            |\det (E)|(|S| - \epsilon) &\leq |\det (E)| \sum_{R \subseteq S} |R| \\
            &= \sum_{R \subseteq S} |T(R)| = \sum_{R \subseteq S} \int \chi_{~int (T(R))} \, dA \leq \underline{\int} \chi_{T(S)}.
        \end{align*}
        Similarly,
        \begin{align*}
            |\det (E)|(|S| + \epsilon) &\geq |\det (E)| \sum_{R: R\cap S \neq \emptyset} |R| \\
            &= \sum_{R: R\cap S \neq \emptyset} |T(R)| = \sum_{R: R\cap S \neq \emptyset} \int \chi_{T(R)} \, dA \geq \overline{\int} \chi_{T(S)}.
        \end{align*}
        Since $\epsilon$ is arbitrary, we have
        \[
        \underline{\int} \chi_{T(S)} = |\det (E)| |S| = \overline{\int} \chi_{T(S)},
        \]
        hence proved.
    \end{proof}
\end{prop}

\begin{rmk}
    The proposition can be generalized to higher dimensions $\R^n$, and is called the volume multiplier formula.
\end{rmk}

\begin{df}
    A norm on a vector space $V$ (over $\R$) is a function $\|\cdot\|: V \to [0, \infty)$ such that
    \begin{enumerate}
        \item $\|v\| \geq 0$ for all $v \in V$, and $\|v\| = 0$ iff $v = 0$.
        \item $\|\lambda v\| = |\lambda| \|v\|$ for all $\lambda \in \R$ and $v \in V$.
        \item $\|v + w\| \leq \|v\| + \|w\|$ for all $v, w \in V$ (triangle inequality).
    \end{enumerate}
\end{df}

A vector space with a norm is called a normed space. A norm gives rise to a metric by defining $d(v, w) = \|v - w\|.$ If $V, W$ are normed spaces and if $T: V \to W$ is a linear transformation, then we can define the operator norm of $T$ to be
\[
\|T\| = \sup_{\|v\| = 1} \|T(v)\|.
\]
Consider $V = W = \R^2$ with the $\sup$-norm
\[
\|(x, y)\| = \max\{|x|, |y|\}.
\]
The closed $r$-neighborhood of $z \in \R^2$ is a square $S(x, r)$ under this norm. Write $S(r) := S(0, r)$.

\begin{lm}
    \label{lm:perturbation_of_identity}
    Let $\mathcal U$ be open with $0 \in \mathcal U$, and let $\sigma \in (0, 1)$. Suppose that $\psi: \mathcal U \to \R^2$ is $C^1$ such that $\psi(0) = 0$, and for all $u \in \mathcal U$, we have $\|(D\psi)_u - I\| \leq \sigma$. If $S(r) \subseteq \mathcal U$, then
    \[
    S(r(1 - \sigma)) \subseteq \psi(S(r)) \subseteq S(r(1 + \sigma)).
    \]
    \begin{proof}
        Define $\rho(u) = \psi(u) - u$, then $\rho$ is $C^1$, $\rho(0) = 0$, and $\|(D\rho)_u\| \leq \sigma$ for all $u \in \mathcal U$. For any $\|u\| \leq r$, by the Mean Value Theorem, 
        \[
        \|\psi(u)\| \leq \|u\| + \|\rho(u)\| \leq r + \sigma r = r(1 + \sigma) \leadsto \psi(S(r)) \subseteq S(r(1 + \sigma)).
        \]

        For the other side, we wish to show that for every $\|v\| \leq r(1 - \sigma)$, there exists $u \in S(r)$ such that $\psi(u) = v$. Define $K_v: S(r) \to \R^2$ by $K_v(u) = v - \rho(u)$. Note that $K_v$ is continuous and $K_v(S(r)) \subseteq S(r)$ since for all $\|u\| \leq r$,
        \[
        \|K_v(u)\| \leq \|v\| + \|\rho(u)\| \leq r(1 - \sigma) + \sigma r = r.
        \]
        By Banach Fixed Point Theorem, $K_v$ has a unique fixed point $u \in S(r)$ such that $K_v(u) = u$, hence $\psi(u) = v$. Therefore, $S(r(1 - \sigma)) \subseteq \psi(S(r))$.
    \end{proof}
\end{lm}

\begin{lm}
    \label{lm:lipschitz_measure_zero}
    The Lipschitz image of a set of measure zero has measure zero.
    \begin{proof}
        Let $Z \subseteq \R^2$ be a set of measure zero, and let $h: \R^2 \to \R^2$ be Lipschitz with Lipschitz constant $L > 0$. Given $\epsilon > 0$, $\exists$ a countable cover of $Z$ by open squares $S_k$ such that
        \[
        \sum_{k=1}^\infty |S_k| < \frac{\epsilon}{L^2}.
        \]
        Note that
        \[
        ~diam (h(S_k \cap Z)) \leq L ~diam (S_k \cap Z) \leq L ~diam (S_k)
        \]
        w.r.t. the $\sup$-norm. Therefore, $h(S_k \cap Z)$ is contained in an open square $S_k'$ of side length $L ~diam (S_k)$, hence $\set{S_k'}$ is a countable cover of $h(Z)$ by open squares such that
        \[
        \sum_{k=1}^\infty |S_k'| = \sum_{k=1}^\infty L^2 |S_k| < \epsilon.
        \]
        Since $\epsilon$ is arbitrary, $h(Z)$ has measure zero.
    \end{proof}
\end{lm}

\begin{thm}
    Let $f$ be Riemann integrable, and let $\varphi: R \to \R^2$ be a $C^1$-diffeomorphism, then
    \[
    \int_R f \circ \varphi \cdot \abs{\det (D\varphi)} \, dA = \int_{\varphi(R)} f \, dA.
    \]
    \begin{proof}
        We first verify that the integrands on both sides are Riemann integrable. 
        
        Let $\mathcal D'$ be the set of discontinuities of $f$. Define $\mathcal D = \varphi^{-1}(\mathcal D')$ to be the set of discontinuities of $f \circ \varphi$. Since $\varphi$ is a $C^1$-diffeomorphism, $\varphi^{-1}$ is Lipschitz, thus by Lemma \ref{lm:lipschitz_measure_zero}, $\mathcal D$ has measure zero, thus $f \circ \varphi$ is Riemann integrable. The function $\abs{\det (D\varphi)}$ is continuous, hence Riemann integrable, and the product of two Riemann integrable functions is Riemann integrable, thus the integrand on the left-hand side is Riemann integrable.

        Since $\varphi$ is a $C^1$-diffeomorphism, in particular it is a homeomorphism, hence $\varphi(\partial R) = \partial (\varphi(R))$. Since $\partial R$ has measure zero, so does $\varphi(\partial R)$ by Lemma \ref{lm:lipschitz_measure_zero} again, hence $\varphi(R)$ is Riemann measurable and $\chi_{\varphi(R)}$ is Riemann integrable. 

        We may assume that $f \geq 0$ since we can decompose $f$ into
        \[
        f = f^+ - f^-, \quad f^+ = \max\{f, 0\}, \quad f^- = \max\{-f, 0\}.
        \]

        Take any grid partition of $R$ into $R_{ij}$ of radius at most $r$. Let $z_{ij}$ be the center of $R_{ij}$ and define
        \[
        A_{ij} = (D\varphi)_{z_{ij}}, \quad \varphi(z_{ij}) = w_{ij}, \quad \varphi(R_{ij}) = W_{ij}.
        \]
        The affine approximation of $\varphi$ at $z_{ij}$ is
        \[
        \phi_{ij}(z) = A_{ij}(z - z_{ij}) + w_{ij}.
        \]
        Define $\psi = \phi_{ij}^{-1} \circ \varphi$, then $\psi_{z_{ij}} = z_{ij}$ and $(D\psi)_{z_{ij}} = I$. Since $(D\psi)_z$ is uniformly continuous on the compact set $R$, $\forall R_{ij}$ and for all $z \in R_{ij}$, if $r$ is sufficiently small, then
        \[
        \|(D\psi)_z - I\| < \sigma,
        \]
        for arbitrarily small $\sigma > 0$. By \ref{lm:perturbation_of_identity}, $\psi(R_{ij})$ is sandwiched between the squares $S(z_{ij}, r(1 - \sigma))$ and $S(z_{ij}, r(1 + \sigma))$. Applying $\phi_{ij}$, we see that
        \begin{gather*}
            \phi_{ij}(S(z_{ij}, r(1 - \sigma))) \subseteq W_{ij} \subseteq \phi_{ij}(S(z_{ij}, r(1 + \sigma))) \\
            \implies (1 - \sigma)^2 |\det (A_{ij})| |R_{ij}| \leq |W_{ij}| \leq (1 + \sigma)^2 |\det (A_{ij})| |R_{ij}|.
        \end{gather*}
        Let $m_{ij} = \inf_{R_{ij}} f \circ \varphi$ and $M_{ij} = \sup_{R_{ij}} f \circ \varphi$, then for all $w \in \varphi(R)$,
        \[
        \sum_{i, j} m_{ij} \chi_{~int (W_{ij})}(w) \leq f(w) \leq \sum_{i, j} M_{ij} \chi_{W_{ij}}(w).
        \]
        By integrating over $\varphi(R)$, we have
        \begin{gather*}
            \sum_{i, j} m_{ij} |W_{ij}| \leq \int_{\varphi(R)} f(w) \, dA \leq \sum_{i, j} M_{ij} |W_{ij}| \\
            \implies (1 - \sigma)^2 \sum_{i, j} m_{ij} |\det (A_{ij})| |R_{ij}| \leq \int_{\varphi(R)} f(w) \, dA \leq (1 + \sigma)^2 \sum_{i, j} M_{ij} |\det (A_{ij})| |R_{ij}|.
        \end{gather*}
        By uniform continuity of $\det (D\varphi)$, if $r$ is sufficiently small, then for all $z \in R_{ij}$,
        \[
        1 - \tau \leq \frac{|\det (D\varphi)_z|}{|\det (A_{ij})|} \leq 1 + \tau,
        \]
        for arbitrarily small $\tau > 0$. Let $L$ be the lower sum of $f \circ \varphi \cdot |\det (D\varphi)|$ with respect to the partition $R_{ij}$, and let $U$ be the corresponding upper sum, then
        \begin{gather*}
            (1 - \tau) L \leq \sum_{i, j} m_{ij} |\det A_{ij}| |R_{ij}|, \quad \sum_{i, j} M_{ij} |\det A_{ij}| |R_{ij}| \leq (1 + \tau) U \\
            \implies (1 - \sigma)^2 (1 - \tau) L \leq \int_{\varphi(R)} f(w) \, dA \leq (1 + \sigma)^2 (1 + \tau) U.
        \end{gather*}
        Since $\sigma, \tau$ can be arbitrarily small when $r$ approaches $0$, we have
        \[
        \underline{\int}_R f \circ \varphi(z) |\det (D\varphi)_z| \, dA \leq \int_{\varphi(R)} f(w) \, dA \leq \overline{\int}_R f \circ \varphi(z) |\det (D\varphi)_z| \, dA,
        \]
        hence proved.
    \end{proof}
\end{thm}

\chapter{Function Spaces}

\section{Uniform Convergence and Completeness}

A sequence of functions $f_n: [a, b] \to \R$ converges uniformly to a function $f: [a, b] \to \R$ if for every $\epsilon > 0$, $\exists N \in \N$ such that for all $n \geq N$ and for all $x \in [a, b]$,
\[
|f_n(x) - f(x)| < \epsilon.
\]
We say that $f$ is the uniform limit of $f_n$, and write $f_n \rightrightarrows f$. Uniform convergence implies pointwise convergence, but not vice versa.

\begin{prop}
    \label{prop:uniform_limit_continuous}
    If $f_n \rightrightarrows f$ and each $f_n$ is continuous at $x$, then $f$ is continuous at $x$.
    \begin{proof}
        Given $\epsilon > 0$, choose $N$ such that for all $n \geq N$ and for all $y \in [a, b]$,
        \[
        |f_n(y) - f(y)| < \frac{\epsilon}{3}.
        \]
        Since $f_N$ is continuous at $x$, $\exists \delta > 0$ such that for all $y \in [a, b]$ with $|y - x| < \delta$,
        \[
        |f_N(y) - f_N(x)| < \frac{\epsilon}{3}.
        \]
        Therefore, if $|y - x| < \delta$, then
        \begin{align*}
            |f(y) - f(x)| &\leq |f(y) - f_N(y)| + |f_N(y) - f_N(x)| + |f_N(x) - f(x)| \\
            &< \frac{\epsilon}{3} + \frac{\epsilon}{3} + \frac{\epsilon}{3} = \epsilon.
        \end{align*}
        Hence proved.
    \end{proof}
\end{prop}

\begin{rmk}
    Even if $f_n \to f$ pointwise and the limit $f$ is continuous, $f_n$ may not converge uniformly to $f$. For example, let
    \[
    f_n(x) = \begin{cases}
        nx, & 0 \leq x \leq \frac1n, \\
        2 - nx, & \frac1n < x \leq \frac2n, \\
        0, & \text{otherwise},
    \end{cases}
    \]
    then $f_n \to 0$ pointwise, but not uniformly.
\end{rmk}

Let
\[
C_b = C_b([a, b], \R) = \set{f: [a, b] \to \R \mid \text{$f$ is bounded}}.
\]
Define the supremum norm on $C_b$ by
\[
\|f\| = \sup_{x \in [a, b]} |f(x)|.
\]
In order to distinguish from other norms, sometimes we write $\|f\|_\infty$ for the supremum norm. Define a metric on $C_b$ by $d(f, g) = \|f - g\|$.

\begin{prop}
    Convergence with respect to the supremum norm is equivalent to uniform convergence.
    \begin{proof}
        $f_n \rightrightarrows f$ iff for every $\epsilon > 0$, $\exists N \in \N$ such that for all $n \geq N$ and for all $x \in [a, b]$,
        \[
        |f_n(x) - f(x)| < \epsilon \iff \sup_{x \in [a, b]} |f_n(x) - f(x)| < \epsilon \iff \|f_n - f\| < \epsilon.
        \]
        Hence proved.
    \end{proof}
\end{prop}

\begin{thm}
    $C_b$ is a complete metric space with respect to the supremum norm.
    \begin{proof}
        Let $(f_n)$ be a Cauchy sequence in $C_b$. For each fixed $x \in [a, b]$, $(f_n(x))$ is a Cauchy sequence in $\R$ since
        \[
        |f_n(x) - f_m(x)| \leq \|f_n - f_m\|.
        \]
        So for each $x \in [a, b]$, we can define
        \[
        f(x) := \lim_{n \to \infty} f_n(x).
        \]
        Clearly $f_n \to f$ pointwise. Given $\epsilon > 0$, choose $N$ such that for all $m, n \geq N$,
        \[
        \|f_n - f_m\| < \frac{\epsilon}{2}.
        \]
        For each fixed $x \in [a, b]$, exists $m(x) \geq N$ depending on $x$ such that
        \[
        |f_m(x) - f(x)| < \frac{\epsilon}{2}.
        \]
        If $n \geq N$ and $x \in [a, b]$, then
        \[
        |f_n(x) - f(x)| \leq |f_n(x) - f_{m(x)}(x)| + |f_{m(x)}(x) - f(x)| < \frac{\epsilon}{2} + \frac{\epsilon}{2} = \epsilon.
        \]
        Therefore, for all $n \geq N$,
        \[
        \|f_n - f\| = \sup_{x \in [a, b]} |f_n(x) - f(x)| \leq \epsilon,
        \]
        hence $f_n \to f$ uniformly. Since each $f_n$ is bounded, so is $f$, thus $f \in C_b$. Hence proved.
    \end{proof}
\end{thm}

Let $C^0 = C^0([a, b], \R)$ be the space of continuous functions on $[a, b]$. Usually, people write $C([a, b])$ or $C([a, b], \R)$ for $C^0([a, b], \R)$. Since every continuous function on a compact set has a compact image, $C^0 \subseteq C_b$. 

\begin{cl}
    $C^0$ is a closed subset of $C_b$, hence a complete metric space with respect to the supremum norm.
    \begin{proof}
        Converging sequences in $C^0$ have continuous limits by Proposition \ref{prop:uniform_limit_continuous}.
    \end{proof}
\end{cl}

\begin{prop}[Weierstrass M-test]
    If $\sum_{n=1}^\infty M_n$ converges and if $|f_n(x)| \leq M_n$ for all $x \in [a, b]$ and for all $n \in \N$, then $\sum_{n=1}^\infty f_n$ converges uniformly and absolutely on $[a, b]$.
    \begin{proof}
        Write $F_n = \sum_{k=1}^n f_k$. If $n > m$, then
        \begin{align*}
            d(F_n, F_m) &\leq d(F_n, F_{n-1}) + d(F_{n-1}, F_{n-2}) + \cdots + d(F_{m+1}, F_m) \\
            &= \sum_{k=m+1}^n \|f_k\| \leq \sum_{k=m+1}^n M_k.
        \end{align*}
        Since $\sum_{n=1}^\infty M_n$ converges, $(F_n)$ is a Cauchy sequence in $C_b$, hence converges uniformly to some $F \in C_b$. Therefore, $\sum_{n=1}^\infty f_n$ converges uniformly to $F$.
    \end{proof}
\end{prop}

\begin{prop}
    The uniform limit of Riemann integrable functions is Riemann integrable, and the limit of the integrals is the integral of the limit, i.e.
    \[
    \lim_{n \to \infty} \int_a^b f_n(x) \, dx = \int_a^b \lim_{n \to \infty} f_n(x) \, dx.
    \]
    \begin{proof}
        Let $f_n \in \mathcal R$ and assume that $f_n \rightrightarrows f$. Each $f_n$ is bounded and exists $Z_n$ of measure zero such that $f_n$ is continuous on $[a, b] \setminus Z_n$. Let $Z = \bigcup_{n=1}^\infty Z_n$, then $Z$ has measure zero and $f$ is continuous on $[a, b] \setminus Z$ by Proposition \ref{prop:uniform_limit_continuous}, hence $f$ is Riemann integrable. To prove the equality, note that
        \[
        \abs{\int_a^b f_n(x) \, dx - \int_a^b f(x) \, dx} \leq \int_a^b |f_n(x) - f(x)| \, dx \leq (b - a) \|f_n - f\| \to 0.
        \]
    \end{proof}
\end{prop}

The above proposition tells us that the space of Riemann integrable functions $\mathcal R$ is closed in $C_b$. Moreover, the functional
\[
f \mapsto \int_a^b f(x) \, dx
\]
is a continuous mapping from $(\mathcal R, d)$ to $\R$.

\begin{prop}
    The uniform limit of a sequence of differentiable functions is differentiable provided that the sequence of derivatives converges uniformly.
    \begin{proof}
        Suppose that $f_n: [a, b] \to \R$ is a sequence of differentiable functions such that $f_n \rightrightarrows f$ and $f_n' \rightrightarrows g$. 

        If each $f_n'$ is continuous, then $f_n', g \in \mathcal R$ and we can apply the Fundamental Theorem of Calculus to get
        \[
        f_n(x) = f_n(a) + \int_a^x f_n'(t) \, dt \rightrightarrows f(a) + \int_a^x g(t) \, dt.
        \]
        Since $f_n \rightrightarrows f$, we have $f(x) = f(a) + \int_a^x g(t) \, dt$, hence $f$ is differentiable with $f' = g$.

        In general, fix some $x \in [a, b]$ and define
        \begin{gather*}
            \phi_n(t) = \begin{cases}
                \dfrac{f_n(t) - f_n(x)}{t - x}, & t \neq x, \\
                f_n'(x), & t = x,
            \end{cases} \\
            \phi(t) = \begin{cases}
                \dfrac{f(t) - f(x)}{t - x}, & t \neq x, \\
                g(x), & t = x.
            \end{cases}
        \end{gather*}
        Note that each $\phi_n$ is continuous and $\phi_n \to \phi$ pointwise. We claim that $\phi_n \rightrightarrows \phi$. For all $m, n \in \N$ and $t \neq x$, we have
        \[
        \phi_m(t) - \phi_n(t) = \frac{(f_m(t) - f_n(t)) - (f_m(x) - f_n(x))}{t - x}.
        \]
        Apply the Mean Value Theorem to the function $f_m - f_n$, we see that there exists $\xi$ between $x$ and $t$ such that
        \[
        \phi_m(t) - \phi_n(t) = (f_m - f_n)'(\xi).
        \]
        Since $f_n' \rightrightarrows g$, $(f_n')$ is a Cauchy sequence in $C_b$, hence $\phi_n$ is a Cauchy sequence in $C_b$ as well. By completeness of $C_b$, $\phi_n \rightrightarrows \psi$ for some continuous function $\psi$. Since $\phi_n \to \phi$ pointwise, we have $\phi = \psi$, in particular, $\phi$ is continuous. Therefore, $f$ is differentiable at $x$ with $f'(x) = g(x)$. 
    \end{proof}
\end{prop}

\begin{rmk}
    If we do not assume the uniform convergence of the derivatives, then the limit function may not be differentiable. For example, let $f_n(x) = \sqrt{x^2 + \frac1n}$, then $f_n \to |x|$ uniformly, but $|x|$ is not differentiable at $0$. The derivatives converge pointwise but not uniformly.
\end{rmk}

\section{Compactness and Equicontinuity in $C^0$}

Recall the Heine-Borel Theorem: a subset of $\R^n$ is compact iff it is closed and bounded. In general, this is not true for $C^0$. Consider the closed unit ball
\[
B = \set{f \in C^0([0, 1], \R) \mid \|f\| \leq 1}.
\]
$B$ is closed and bounded, but not compact. The problem is that $C^0$ is infinite-dimensional. 

\begin{df}
    A family of functions $(f_\alpha)_{\alpha \in I}$ in $C^0$ is equicontinuous if for every $\epsilon > 0$, $\exists \delta > 0$ such that for all $\alpha \in I$ and for all $|x - y| < \delta$,
    \[
    |f_\alpha(x) - f_\alpha(y)| < \epsilon.
    \]
\end{df}

Note that $\delta$ does not depend on $\alpha$.

\begin{thm}[Arzel\'a-Ascoli]
    Every bounded equicontinuous sequence of functions in $C^0([a, b], \R)$ has a subsequence that converges uniformly on $[a, b]$.
    \begin{proof}
        Let $\mathcal D = \set{d_1, d_2, \ldots}$ be a countable dense subset of $[a, b]$, for example, the set of rational numbers in $[a, b]$. Let $(f_n)$ be a bounded equicontinuous sequence in $C^0([a, b], \R)$. 

        There exists some $M > 0$ such that $|f_n(x)| \leq M$ for all $x \in [a, b]$ and for all $n \in \N$. Since $(f_n(d_1))$ is a bounded sequence in $\R$, it has a convergent subsequence $(f_{n(1, k)}(d_1)) \to y_1$ as $k \to \infty$. Write $f_{k}^{(1)}$ for $f_{n(1, k)}$. Find a subsequence $(f_k^{(2)})$ of $(f_k^{(1)})$ such that $(f_k^{(2)}(d_2))$ converges to some $y_2$. Continuing this process, we obtain a nested sequence of subsequences $(f_k^{(m)})$, and if $j \leq m$ then $f_k^{(m)}(d_j)$ converges to $y_j$ as $k \to \infty$. Define $g_m = f_m^{(m)}$. We claim that $g_m$ converges pointwise on $\mathcal D$.

        Fix $j \in \N$. Since $(f_k^{(m)})$ is a nested sequence of subsequences, for all $m \geq j$, we have
        \[
        f_m^{(m)} = f_{r_1}^{(m-1)} = f_{r_2}^{(m-2)} = \cdots = f_{r}^{(j)},
        \]
        where $r \geq r_{m-j-1} \geq \cdots \geq r_1 \geq m$. Then
        \[
        g_m(d_j) = f_m^{(m)}(d_j) = f_r^{(j)}(d_j) \to y_j \text{ as } m \to \infty,
        \]
        hence $g_m$ converges pointwise on $\mathcal D$. 
        
        We then show that $(g_m)$ is a Cauchy sequence in $C^0$. Given $\epsilon > 0$, by equicontinuity, $\exists \delta > 0$ such that for all $x, y \in [a, b]$ with $|x - y| < \delta$ and for all $m \in \N$,
        \[
        |g_m(x) - g_m(y)| < \frac{\epsilon}{3}.
        \]
        Since $[a, b]$ is compact and $\mathcal D$ is dense in $[a, b]$, we can find a finite subset $\set{d_1, d_2, \ldots, d_J} \subseteq \mathcal D$ such that every $x \in [a, b]$ is within $\delta$ of some $d_j$. Since $g_m(d_j) \to y_j$ for each $j$, $\exists N \in \N$ such that for all $l, m \geq N$ and for all $1 \leq j \leq J$,
        \[
        |g_m(d_j) - g_l(d_j)| < \frac{\epsilon}{3}.
        \]
        Thus, if $l, m \geq N$ and $x \in [a, b]$, then choose some $d_j$ such that $|x - d_j| < \delta$, we have
        \begin{align*}
            |g_m(x) - g_l(x)| &\leq |g_m(x) - g_m(d_j)| + |g_m(d_j) - g_l(d_j)| + |g_l(d_j) - g_l(x)| \\
            &< \frac{\epsilon}{3} + \frac{\epsilon}{3} + \frac{\epsilon}{3} = \epsilon.
        \end{align*}
        Therefore, $(g_m)$ is a Cauchy sequence in $C^0$, hence converges in $C^0$, i.e. uniformly on $[a, b]$.
    \end{proof}
\end{thm}

\begin{rmk}
    The theorem can be regarded as a characterization of compactness on $C^0$. If $(f_n)$ is a sequence of bounded equicontinuous functions, then the set $\set{f_n \mid n \in \N}$ is precompact, i.e. its closure is compact.
\end{rmk}

\begin{prop}
    If $(f_n)$ is an equicontinuous sequence in $C^0$ that converges pointwise on a dense subset of $[a, b]$, then it converges uniformly on $[a, b]$.
    \begin{proof}
        Similar to the second part of the proof of the Arzel\'a-Ascoli Theorem.
    \end{proof}
\end{prop}

\begin{cl}
    Assume that $f_n: [a, b] \to \R$ is a sequence of differentiable functions such whose derivatives are uniformly bounded, i.e. $\exists M > 0$ such that $|f_n'(x)| \leq M$ for all $n \in \N$ and for all $x \in [a, b]$. If for a point $x_0 \in [a, b]$, the sequence $(f_n(x_0))$ is bounded, then $(f_n)$ has a uniformly convergent subsequence.
    \begin{proof}
        To use Arzel\'a-Ascoli, we need to show that $(f_n)$ is bounded and equicontinuous. Let $M$ be a bound of the derivatives. For any $x, y \in [a, b]$, by the Mean Value Theorem, $\exists \xi$ between $x$ and $y$ such that
        \[
        |f_n(x) - f_n(y)| = |f_n'(\xi)| |x - y| \leq M |x - y|.
        \]
        Thus, $(f_n)$ is equicontinuous. 

        Let $K$ be a bound of $|f_n(x_0)|$. Then for any $x \in [a, b]$, by the Mean Value Theorem again, $\exists \xi$ between $x$ and $x_0$ such that
        \begin{align*}
            |f_n(x)| &\leq |f_n(x_0)| + |f_n(x) - f_n(x_0)| \\
            &= |f_n(x_0)| + |f_n'(\xi)| |x - x_0| \\
            &\leq K + M(b - a).
        \end{align*}
        Therefore, $(f_n)$ is bounded. By Arzel\'a-Ascoli, $(f_n)$ has a uniformly convergent subsequence.
    \end{proof}
\end{cl}

\begin{thm}
    A subset $\mathcal E \subseteq C^0$ is compact iff it is closed, bounded and equicontinuous.
    \begin{proof}
        Assume that $\mathcal E$ is compact. Then $\mathcal E$ is closed and bounded. Let $\epsilon > 0$. Since $\mathcal E$ is compact, there exists a finite cover of $\mathcal E$ by open balls $B(f_i, \epsilon/3)$, $i = 1, 2, \ldots, N$. Each $f_i$ is uniformly continuous (continuous functions on compact sets are uniformly continuous), hence $\exists \delta > 0$ such that for all $x, y \in [a, b]$ with $|x - y| < \delta$,
        \[
        |f_i(x) - f_i(y)| < \frac{\epsilon}{3}, \quad i = 1, 2, \ldots, N.
        \]
        If $f \in \mathcal E$, then $f \in B(f_k, \epsilon/3)$ for some $k$, hence for all $x, y \in [a, b]$ with $|x - y| < \delta$,
        \begin{align*}
            |f(x) - f(y)| &\leq |f(x) - f_k(x)| + |f_k(x) - f_k(y)| + |f_k(y) - f(y)| \\
            &< \frac{\epsilon}{3} + \frac{\epsilon}{3} + \frac{\epsilon}{3} = \epsilon.
        \end{align*}
        Therefore, $\mathcal E$ is equicontinuous.

        Conversely, assume that $\mathcal E$ is closed, bounded and equicontinuous. Let $(f_n)$ be a sequence in $\mathcal E$. By Arzel\'a-Ascoli, $(f_n)$ has a uniformly convergent subsequence $(f_{n_k})$ that converges to some $f \in C^0$. Since $\mathcal E$ is closed, $f \in \mathcal E$. Therefore, every sequence in $\mathcal E$ has a convergent subsequence whose limit is in $\mathcal E$, hence $\mathcal E$ is compact.
    \end{proof}
\end{thm}

We can generalize the above theorem to general metric spaces. Let $X$ be a metric space, and $Y$ be a complete metric space. Let $\mathcal F$ denote the set of functions from $X$ to $Y$. Consider
\[
\rho(y, y') = \frac{d_Y(y, y')}{1 + d_Y(y, y')}, \quad y, y' \in Y,
\]
then $\rho$ is a bounded metric on $Y$ that induces the same topology as $d_Y$. In particular, $(Y, \rho)$ is also complete. Define a metric on $\mathcal F$ by
\[
d(f, g) = \sup_{x \in X} \frac{\rho(f(x), g(x))}{1 + \rho(f(x), g(x))}, \quad f, g \in \mathcal F.
\]
We say that a function $f \in \mathcal F$ is bounded with respect to $d_Y$ iff for any constant function $c$, we have $\sup_{x \in X} d_Y(f(x), c) < \infty$, or equivalently, $d(f, c) < 1$. A function $f \in \mathcal F$ is unbounded if $d(f, c) = 1$ for some constant function $c$. 

\begin{prop}
    In $(\mathcal F, d)$, the following holds:
    \begin{enumerate}[label=(\alph*)]
        \item Uniform convergence of $(f_n)$ is equivalent to convergence with respect to $d$.
        \item Completeness of $Y$ implies completeness of $\mathcal F$.
        \item The set $\mathcal F_b$ of bounded functions in $\mathcal F$ is closed in $\mathcal F$.
        \item The set $C^0(X, Y)$ of continuous functions in $\mathcal F$ is closed in $\mathcal F$.
    \end{enumerate}
    \begin{proof}
        \nobreakspace
        \begin{enumerate}[label=(\alph*)]
            \item $f$ being the uniform limit of $(f_n)$ is equivalent to $d_Y(f_n(x), f(x)) \rightrightarrows 0$, which is equivalent to $d$-convergence.
            \item Similar to the proof of completeness of $C_b$. Let $(f_n)$ be a Cauchy sequence in $\mathcal F$. Completeness of $Y$ implies $f(x) := \lim_{n \to \infty} f_n(x)$ exists for each $x \in X$. Cauchyness of $(f_n)$ implies uniform convergence and $f_n \to f$ with respect to $d$.
            \item If $f_n \in \mathcal F_b$ and $d(f_n, f) \to 0$, then for any constant function $c$,
            \[
            d(f, c) \leq d(f, f_n) + d(f_n, c) < 1,
            \]
            for sufficiently large $n$, hence $f \in \mathcal F_b$.
            \item If $f_n \in C^0(X, Y)$ and $d(f_n, f) \to 0$, then for each fixed $x \in X$, $f_n(x) \to f(x)$. Given $\epsilon > 0$, choose $N$ such that for all $n \geq N$ and for all $x \in X$, $d(f_n(x), f(x)) < \epsilon/3$. Since $f_N$ is continuous at $x$, $\exists \delta > 0$ such that for all $y \in X$ with $d_X(x, y) < \delta$, $d_Y(f_N(x), f_N(y)) < \epsilon/3$. Therefore, if $d_X(x, y) < \delta$, then for all $n \geq N$,
            \begin{align*}
                d_Y(f(x), f(y)) &\leq d_Y(f(x), f_n(x)) + d_Y(f_n(x), f_n(y)) + d_Y(f_n(y), f(y)) \\
                &< \frac{\epsilon}{3} + \frac{\epsilon}{3} + \frac{\epsilon}{3} = \epsilon.
            \end{align*}
            Hence $f$ is continuous at $x$.
        \end{enumerate}
    \end{proof}
\end{prop}

\begin{df}
    \nobreakspace
    \begin{itemize}
        \item A family of functions $\mathcal E \subseteq \mathcal F$ is equicontinuous if for every $\epsilon > 0$, exists $\delta > 0$ such that for all $f \in \mathcal E$ and for all $x, x' \in X$ with $d_X(x, x') < \delta$,
        \[
        d_Y(f(x), f(x')) < \epsilon.
        \]
        \item $\mathcal E$ is pointwise equicontinuous if the $\delta$ above may depend on $x$, i.e. for every $\epsilon > 0$ and for every $x \in X$, exists $\delta > 0$ such that for all $f \in \mathcal E$ and for all $x' \in X$ with $d_X(x, x') < \delta$,
        \[
        d_Y(f(x), f(x')) < \epsilon.
        \]
    \end{itemize}
\end{df}

\begin{prop}
    If $X$ is compact, then equicontinuity and pointwise equicontinuity of $\mathcal E$ are equivalent.
    \begin{proof}
        Suppose not, then $\exists \epsilon > 0$ such that for all $\delta = 1/n$, $\exists x_n, x_n' \in X$ and functions $f_n \in \mathcal E$ such that $d_X(x_n, x_n') < 1/n$ but $d_Y(f_n(x_n), f_n(x_n')) \geq \epsilon$. By compactness of $X$, exists a subsequence $(x_{n_k})$ that converges to some $x_0 \in X$. Then $x_{n_k}' \to x_0$ as well. By pointwise equicontinuity, $\exists \delta > 0$ such that $d_X(x, x_0) < \delta$ implies $d_Y(f(x), f(x_0)) < \epsilon/2$ for all $f \in \mathcal E$. Take $x = x_{n_k}, x_{n_k}'$ and $f = f_{n_k}$ for sufficiently large $k$, then
        \begin{align*}
            \epsilon &\leq d_Y(f_{n_k}(x_{n_k}), f_{n_k}(x_{n_k}')) \\
            &\leq d_Y(f_{n_k}(x_{n_k}), f_{n_k}(x_0)) + d_Y(f_{n_k}(x_0), f_{n_k}(x_{n_k}')) \\
            &< \frac{\epsilon}{2} + \frac{\epsilon}{2} = \epsilon,
        \end{align*}
        a contradiction.
    \end{proof}
\end{prop}

\begin{prop}
    If the sequence of functions $(f_n)$ in $\mathcal F$ is uniformly equicontinuous, $X$ is compact, and for each $x \in X$, the sequence $(f_n(x))$ lies in a compact subset of $Y$, then $(f_n)$ has a uniformly convergent subsequence.
    \begin{proof}
        Since $X$ is compact, it is separable, i.e. has a countable dense subset. The rest is similar to the proof of the Arzel\'a-Ascoli Theorem.
    \end{proof}
\end{prop}

\begin{df}
    A topological space $X$ is $\sigma$-compact if it is a countable union of compact subsets.
\end{df}

\begin{ex}
    $\Z, \Q, \R$ are $\sigma$-compact. Uncountable sets equipped with the discrete topology are not $\sigma$-compact.
\end{ex}

\begin{prop}
    If $X$ is $\sigma$-compact and if $(f_n)$ is a sequence of pointwise equicontinuous functions in $\mathcal F$ such that for each $x \in X$, the sequence $(f_n(x))$ lies in a compact subset of $Y$, then $(f_n)$ has a subsequence that converges uniformly on every compact subset of $X$.
\end{prop}